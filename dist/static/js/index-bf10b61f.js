function e(){import.meta.url,import("_").catch((()=>1))}import{r as t,w as a,o as l,a as o,d as r,b as n,c as s,e as i,f as u,g as c,h as d,u as _,t as p,i as f,j as b,k as v,T as m,B as g,M as h,l as w,m as y,n as S,p as T,F as C,D as O,q as k,s as E,C as A,v as j,x,y as P,I as M,S as I,z as L,O as z,A as V,E as D,G as R,H as U,J as W,K as $,L as H,N as B,P as N,Q as G,R as F,U as q,V as K,W as Y,X as J,Y as Q,Z as X,_ as Z,$ as ee,a0 as te,a1 as ae,a2 as le,a3 as oe,a4 as re,a5 as ne,a6 as se,a7 as ie,a8 as ue,a9 as ce,aa as de,ab as _e,ac as pe,ad as fe,ae as be,af as ve}from"./.pnpm-22857cbc.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const me=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_1-3c7fc505.webp"},Symbol.toStringTag,{value:"Module"})),ge=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_10-cdffa6ab.webp"},Symbol.toStringTag,{value:"Module"})),he=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_11-d175b882.webp"},Symbol.toStringTag,{value:"Module"})),we=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_12-aa2654f6.webp"},Symbol.toStringTag,{value:"Module"})),ye=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_13-1d98f6fe.webp"},Symbol.toStringTag,{value:"Module"})),Se=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_14-e9f19696.webp"},Symbol.toStringTag,{value:"Module"})),Te=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_15-fe682768.webp"},Symbol.toStringTag,{value:"Module"})),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_16-4a96f5c0.webp"},Symbol.toStringTag,{value:"Module"})),Oe=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_2-8f514ef4.webp"},Symbol.toStringTag,{value:"Module"})),ke=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_18-f6495ba0.webp"},Symbol.toStringTag,{value:"Module"})),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_19-e69559f6.webp"},Symbol.toStringTag,{value:"Module"})),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_2-8f514ef4.webp"},Symbol.toStringTag,{value:"Module"})),je=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_20-97cc1b4e.webp"},Symbol.toStringTag,{value:"Module"})),xe=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_21-eb1491fc.webp"},Symbol.toStringTag,{value:"Module"})),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_22-bd4d7b79.webp"},Symbol.toStringTag,{value:"Module"})),Me=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_23-4e88c4c3.webp"},Symbol.toStringTag,{value:"Module"})),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_24-9bd1e134.webp"},Symbol.toStringTag,{value:"Module"})),Le=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_25-3405a612.webp"},Symbol.toStringTag,{value:"Module"})),ze=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_26-0cbf4eec.webp"},Symbol.toStringTag,{value:"Module"})),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_27-2a36802d.webp"},Symbol.toStringTag,{value:"Module"})),De=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_28-0964a7b4.webp"},Symbol.toStringTag,{value:"Module"})),Re=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_29-d15bed96.webp"},Symbol.toStringTag,{value:"Module"})),Ue=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_3-f6e09394.webp"},Symbol.toStringTag,{value:"Module"})),We=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_30-72380853.webp"},Symbol.toStringTag,{value:"Module"})),$e=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_31-ea4dbf65.webp"},Symbol.toStringTag,{value:"Module"})),He=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_32-54189dcb.webp"},Symbol.toStringTag,{value:"Module"})),Be=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_33-10c4e4c7.webp"},Symbol.toStringTag,{value:"Module"})),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_34-ad543579.webp"},Symbol.toStringTag,{value:"Module"})),Ge=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_35-7742e627.webp"},Symbol.toStringTag,{value:"Module"})),Fe="/static/webp/user_avatar_36-01c052bc.webp",qe=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"})),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_4-e4407157.webp"},Symbol.toStringTag,{value:"Module"})),Ye=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_5-ed7e3439.webp"},Symbol.toStringTag,{value:"Module"})),Je=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_6-1d9247ea.webp"},Symbol.toStringTag,{value:"Module"})),Qe=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_7-552fc562.webp"},Symbol.toStringTag,{value:"Module"})),Xe=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_8-5e8cee41.webp"},Symbol.toStringTag,{value:"Module"})),Ze=Object.freeze(Object.defineProperty({__proto__:null,default:"/static/webp/user_avatar_9-d4eab830.webp"},Symbol.toStringTag,{value:"Module"})),et=Object.assign({"./user_avatar_1.webp":me,"./user_avatar_10.webp":ge,"./user_avatar_11.webp":he,"./user_avatar_12.webp":we,"./user_avatar_13.webp":ye,"./user_avatar_14.webp":Se,"./user_avatar_15.webp":Te,"./user_avatar_16.webp":Ce,"./user_avatar_17.webp":Oe,"./user_avatar_18.webp":ke,"./user_avatar_19.webp":Ee,"./user_avatar_2.webp":Ae,"./user_avatar_20.webp":je,"./user_avatar_21.webp":xe,"./user_avatar_22.webp":Pe,"./user_avatar_23.webp":Me,"./user_avatar_24.webp":Ie,"./user_avatar_25.webp":Le,"./user_avatar_26.webp":ze,"./user_avatar_27.webp":Ve,"./user_avatar_28.webp":De,"./user_avatar_29.webp":Re,"./user_avatar_3.webp":Ue,"./user_avatar_30.webp":We,"./user_avatar_31.webp":$e,"./user_avatar_32.webp":He,"./user_avatar_33.webp":Be,"./user_avatar_34.webp":Ne,"./user_avatar_35.webp":Ge,"./user_avatar_36.webp":qe,"./user_avatar_4.webp":Ke,"./user_avatar_5.webp":Ye,"./user_avatar_6.webp":Je,"./user_avatar_7.webp":Qe,"./user_avatar_8.webp":Xe,"./user_avatar_9.webp":Ze});Object.keys(et).forEach((e=>{e.replace("./","").replace(".webp",""),et[e].default}));const tt="AI 2023",at="/E-WeChat.jpg",lt=["gpt-4","gpt-3.5-turbo"],ot={"gpt-4":20,"gpt-3.5-turbo":3,"gpt-4-32k-0314":0,"gpt-4-32k":0,"gpt-4-0314":0,"gpt-3.5-turbo-0301":0,"text-davinci-003":0,"text-davinci-002":0,"text-curie-001":0,"text-babbage-001":0,"text-ada-001":0,"text-davinci-001":0,"davinci-instruct-beta":0,davinci:0,"curie-instruct-beta":0,curie:0,ada:0,babbage:0},rt="/v1/images/generations",nt=[{tag:"未来科技",keywords:"高科技、未来技术、智能化、机器人、自动化、人工智能、机器学习"},{tag:"自然生态",keywords:"大自然、环境保护、生态平衡、气候变化、可持续发展、生物多样性"},{tag:"艺术文化",keywords:"艺术创作、绘画、摄影、雕塑、老文明、历史遗迹、传统手工艺、博物馆"},{tag:"时尚美妆",keywords:"时尚、美妆、个人风格、服装设计、时装周、红毯盛典"},{tag:"美食文化",keywords:"食品、美食文化、烹饪技艺、餐饮业、营养健康、美食分享"},{tag:"旅游文化",keywords:"旅游、景点、旅行体验、文化交流、民俗风情、地方特色"},{tag:"数字化生活",keywords:"社交媒体、数字化、网络文化、在线教育、游戏娱乐、移动支付"},{tag:"娱乐休闲",keywords:"电影、电视剧、综艺节目、音乐会、演唱会、运动会"},{tag:"商业经济",keywords:"商业、经济、金融、股票、基金、保险、创业、创新、投资、贸易"},{tag:"教育培训",keywords:"教育、培训、学习、教育科技、校园生活、学生社团、研究生活"},{tag:"科学研究",keywords:"科学、研究、实验室、科学家、科学成果、学术交流、科学普及"},{tag:"数字艺术",keywords:"数码艺术、VR艺术、游戏美术、互动媒体、AR/VR技术"}];function st(e){const r=t(window.innerWidth),n=t(),s=()=>{n.value=r.value<844};a(n,(()=>{e&&e(n.value)}),{immediate:!0}),s();const i=()=>{r.value=window.innerWidth,s()};return l((()=>{window.addEventListener("resize",i)})),o((()=>{window.removeEventListener("resize",i)})),{screenWidth:r,isMobileScreen:n}}const it=r("__AI_1024_STORE_LAYOUT",(()=>{const e=t(!1),a=t(!0),l=t(!1),o=t(!0),r=t("light");st((()=>{l.value=!1}));n((()=>{"dark"===r.value?(document.documentElement.classList.add("dark"),document.body.setAttribute("arco-theme","dark")):(document.documentElement.classList.remove("dark"),document.body.removeAttribute("arco-theme"))}));return{collapsed:l,themeMode:r,isShowContact:a,isShowLog:e,changeModeAction:function(e){r.value=e},changeShowLogAction:t=>{e.value=t},toggleCollapsedAction:e=>{l.value=void 0!==e?e:!l.value},headerSettingCollapsed:o,changeShowContactAction:e=>{a.value=e},toggleHeaderCollapsedAction:()=>{o.value=!o.value}}}),{persist:[{storage:localStorage,paths:["themeMode","headerSettingCollapsed"]},{storage:sessionStorage,paths:["isShowContact"]}]}),ut={class:"header-logo gap-x-2"},ct=["alt"],dt={class:"text-base m-0"},_t=d("ul",{class:"p-0 m-0 list-decimal ml-6"},[d("li",null,"修复了部分浏览器无法识别返回的内容和空返回问题。"),d("li",null,"修复了网络或其他错误引起的误积分现象。"),d("li",null,"提升了网络速度，让用户能够更快速地获得所需信息。"),d("li",null,"优化了gpt-4的使用体验。"),d("li",null,"修复了历史消息超长导致的回复一半的问题。"),d("li",null,"提升了部分体验，包括但不限于用户界面的优化和交互体验的改进。"),d("li",null,".......")],-1),pt=d("ul",{class:"p-0 m-0 list-decimal ml-6"},[d("li",null,"DALL-E 绘画功能"),d("li",null,"Midjourney 绘画功能"),d("li",null,"AI语音聊天，AI语音文字识别功能"),d("li",null,"用户登陆注册，个人中心等"),d("li",null,"代理分销，邀请奖励积分"),d("li",null,".......")],-1),ft={class:"flex items-center justify-end"},bt=s({__name:"ChangelogModel",setup(e){const l=it(),o=t(!1);a((()=>l.isShowLog),(e=>{o.value=e}),{immediate:!0});const r=()=>{o.value=!1,l.changeShowLogAction(!1)};return(e,t)=>{const a=m,l=g,n=h;return i(),u(n,{class:"contact-model","esc-to-close":!1,"mask-closable":!1,"title-align":"start",visible:_(o),"onUpdate:visible":t[0]||(t[0]=e=>v(o)?o.value=e:null),onClose:r},{title:c((()=>[d("div",ut,[d("img",{class:"w-6 h-6",src:"/static/svg/openai-66faffcb.svg",alt:"APP_TITLE"in e?e.APP_TITLE:_(tt)},null,8,ct),d("h1",dt,p("APP_TITLE"in e?e.APP_TITLE:_(tt)),1)])])),footer:c((()=>[d("div",ft,[f(l,{onClick:r},{default:c((()=>[b(" 关闭 ")])),_:1})])])),default:c((()=>[d("div",null,[f(a,{heading:1,class:"text-base mt-0"},{default:c((()=>[b(" 本次更新主要针对用户反馈的问题进行了修复和优化： ")])),_:1}),_t,f(a,{heading:1,class:"text-base"},{default:c((()=>[b(" 我们即将准备上线的功能： ")])),_:1}),pt])])),_:1},8,["visible"])}}});var vt=(e=>(e.Enter="Enter",e.ShiftEnter="Shift + Enter",e))(vt||{});const mt=r("__AI_1024_STORE_CONFIG",(()=>{const e=t({$schema:"",api:"",modules:["CHAT"]});l((()=>{c.value=vt.Enter,lt.includes(r.value)||(r.value="gpt-3.5-turbo"),fetch("/bootstrap.json").then((e=>e.json())).then((t=>{e.value=t,_(i.value)}))}));const a=t(!1),o=t("light"),r=t("gpt-3.5-turbo"),s=t(!1),i=t(""),u=t(),c=t(vt.ShiftEnter),d=t(.7);function _(t){s.value=!0,i.value=t;const a=`${e.value.api}/v1/card?card=${t}`;fetch(a).then((e=>e.json())).then((e=>{200!==e.code?(i.value&&w.error(e.msg),u.value=void 0):u.value=e.data})).finally((()=>{s.value=!1}))}st((e=>{a.value=e})),n((()=>{"dark"===o.value?(document.documentElement.classList.add("dark"),document.body.setAttribute("arco-theme","dark")):(document.documentElement.classList.remove("dark"),document.body.removeAttribute("arco-theme"))}));return{card:i,cardInfo:u,bootstrap:e,collapsed:a,themeMode:o,chatModel:r,submitKey:c,temperature:d,setupCardLoading:s,setupCardAction:_,changeModeAction:function(e){o.value=e},toggleCollapsedAction:()=>{a.value=!a.value},changeChatModelAction:function(e){r.value=e},changeSubmitKeyAction:function(e){c.value=e},changeTemperatureAction:function(e){d.value=e<.1?.1:e>2?2:e}}}),{persist:[{storage:localStorage,paths:["themeMode","chatModel","card","submitKey","temperature","cardInfo"]}]}),gt={class:"flex items-center gap-x-4 text-primary"},ht={class:"text-primary"},wt={class:"text-info"},yt={key:1,class:"text-primary"},St=(e,t)=>{const a=e.__vccOpts||e;for(const[l,o]of t)a[l]=o;return a},Tt=St(s({__name:"PointsCard",setup(e){const t=mt(),a=y((()=>t.setupCardLoading));return(e,l)=>{const o=S("icon-refresh"),r=g,n=O,s=k,v=E,m=A;return i(),u(m,{class:"points-card",loading:_(a),bordered:!1},{default:c((()=>[f(v,{size:"mini",column:1},{default:c((()=>[f(n,{label:"账号"},{default:c((()=>[d("span",gt,[d("span",null,p(_(t).cardInfo?"会员":"游客"),1),f(r,{size:"mini",type:"text",onClick:l[0]||(l[0]=e=>_(t).setupCardAction(_(t).card)),shape:"circle"},{default:c((()=>[f(o)])),_:1})])])),_:1}),f(n,{label:"状态"},{default:c((()=>{var e;return[f(s,{size:"small",status:"processing",text:_(t).cardInfo?(null==(e=_(t).cardInfo)?void 0:e.enable)?"正常":"禁用":"正常"},null,8,["text"])]})),_:1}),f(n,{label:"积分"},{default:c((()=>{var e,a;return[_(t).cardInfo?(i(),T(C,{key:0},[d("span",ht,p((null==(e=_(t).cardInfo)?void 0:e.remain_points)||0),1),b(" / "),d("span",wt,p((null==(a=_(t).cardInfo)?void 0:a.points)||0),1)],64)):(i(),T("span",yt,"每日五次免费调用"))]})),_:1})])),_:1})])),_:1},8,["loading"])}}}),[["__scopeId","data-v-4ec5a039"]]),Ct={class:"flex items-center"},Ot=s({__name:"SetupCard",setup(e){const a=mt(),o=t(""),r=y((()=>a.setupCardLoading)),n=()=>{o.value!==a.card&&a.setupCardAction(o.value)};return l((()=>{o.value=a.card})),(e,t)=>{const l=x,s=S("icon-info-circle"),p=P,b=M,m=I;return i(),u(m,{loading:_(r)},{default:c((()=>[f(b,{error:!_(a).cardInfo&&!!_(a).card,modelValue:_(o),"onUpdate:modelValue":t[0]||(t[0]=e=>v(o)?o.value=e:null),type:"password",onBlur:n,"allow-clear":"",placeholder:"请输入积分卡"},{suffix:c((()=>[d("div",Ct,[_(o)?(i(),u(l,{key:0,class:"mb-0",copyable:"","copy-text":_(o)},null,8,["copy-text"])):j("",!0),!_(a).cardInfo&&_(a).card?(i(),u(p,{key:1,content:"您的积分不足、积分卡已过期或输入错误。请检查并重新输入。",position:"bottom","content-style":{maxWidth:"240px","margin-right":"16px"}},{default:c((()=>[f(s,{class:"cursor-pointer text-danger"})])),_:1})):j("",!0)])])),_:1},8,["error","modelValue"])])),_:1},8,["loading"])}}}),kt={class:"text-info"},Et=s({__name:"ChangeChatModel",setup(e){const t=mt(),a=async e=>{String(e).indexOf("gpt-4")>-1?await new Promise(((a,l)=>{h.warning({title:"提示",okText:"继续",hideCancel:!1,content:()=>f("div",{class:"whitespace-pre-wrap flex flex-col gap-y-1 leading-5 indent"},[b("请注意：由于 GPT-4 模型的成本较高，因此问题字数应保持在 1000 个 token 以下（大约 500 个汉字）。如果超出该限制，将自动截断。为了避免 AI 回答内容截断，建议尽量让 AI 一次性回复完整个问题。如果 AI 回答的内容过长，也会造成内容截断，进而引起回复不连贯。如果要使用GPT-4建议在新的会话中使用，是否确认切换至 GPT-4？")]),onOk(){a(),t.changeChatModelAction(e)},onCancel(){l()}})})):t.changeChatModelAction(e)};return(e,l)=>{const o=z,r=V;return i(),u(r,{"model-value":_(t).chatModel,onChange:a,"allow-clear":!1,placeholder:"Please select model..."},{label:c((({data:e})=>[b(p(e.value),1)])),default:c((()=>[(i(!0),T(C,null,L("ALL_MODELS"in e?e.ALL_MODELS:_(lt),(t=>(i(),u(o,{key:t,value:t},{default:c((()=>[b(p(t)+" ",1),d("small",kt,"("+p(("POINTS_MAP"in e?e.POINTS_MAP:_(ot))[t])+"积分一次)",1)])),_:2},1032,["value"])))),128))])),_:1},8,["model-value"])}}}),At="/static/svg/logo-cb0d74c8.svg",jt={class:"header-logo gap-x-2"},xt=["alt"],Pt={class:"text-base m-0"},Mt=d("div",{class:"text-center"},"高速、稳定、国内直接访问的ChatGPT平台",-1),It=d("div",{class:"text-center"},"扫码进群，群内每日分享 Ai 工具应用技能",-1),Lt=d("br",null,null,-1),zt={class:"flex flex-col justify-center items-center gap-y-2 py-2 max-w-1/2 mx-auto"},Vt=["src"],Dt=d("span",{class:""},"微信群",-1),Rt={class:"flex items-center justify-center"},Ut=s({__name:"ContactModel",setup(e){const l=it(),o=t(!1);a((()=>l.isShowContact),(e=>{o.value=e}),{immediate:!0});const r=()=>{o.value=!1,l.changeShowContactAction(!1)};return(e,t)=>{const a=g,l=h;return i(),u(l,{class:"contact-model","esc-to-close":!1,"mask-closable":!1,"title-align":"start",visible:_(o),"onUpdate:visible":t[0]||(t[0]=e=>v(o)?o.value=e:null),onClose:r},{title:c((()=>[d("div",jt,[d("img",{class:"w-6 h-6",src:At,alt:"APP_TITLE"in e?e.APP_TITLE:_(tt)},null,8,xt),d("h1",Pt,p("APP_TITLE"in e?e.APP_TITLE:_(tt)),1)])])),footer:c((()=>[d("div",Rt,[f(a,{onClick:r,type:"primary"},{default:c((()=>[b(" 我已加入 ")])),_:1})])])),default:c((()=>[Mt,It,Lt,d("div",zt,[d("img",{class:"max-w-11/12 border-solid border border-gray-200 p-1",alt:"WeChat",src:"WECHAT_URL"in e?e.WECHAT_URL:_("/WeChat.png")},null,8,Vt),Dt])])),_:1},8,["visible"])}}});function Wt(e=16){return Number(Math.random().toString().substring(3,e)+Date.now()).toString(36)}function $t(e){return{id:Wt(),date:Date.now().valueOf(),role:"user",content:"",...e}}const Ht=r("__AI_1024_STORE_CHAT",(()=>{const e=mt(),a=t(new AbortController),o={id:Wt(),topic:"",sendMemory:!0,messages:[],lastUpdate:(new Date).getTime(),lastSummarizeIndex:0},r=t(),s=t([]),i=t(),u=t(!1);n((()=>{i.value=s.value.find((({id:e})=>e===r.value))}));const c=()=>{var e,t;(null==(e=a.value)?void 0:e.abort)&&(null==(t=a.value)||t.abort());const l=Wt();s.value.unshift(R({...o,topic:"",id:l})),r.value=l},d=e=>{var t;return null==(t=i.value)?void 0:t.messages.find((({id:t})=>e===t))},_=async(t,l,o=!0)=>{var r;if(!(null==t?void 0:t.length))return void w.error("请输入您的消息");const n=await(async t=>{var a;e.chatModel;const l=((null==(a=i.value)?void 0:a.messages)||[]).filter((e=>!e.isError)),o=R(l.concat(t)).map((({role:e,content:t})=>({role:e,content:t})));return o.length>20?o.slice(o.length-20,o.length):o})({role:"user",content:t}),s={card:(null==(r=e.cardInfo)?void 0:r.enable)?e.card:void 0,messages:n,temperature:e.temperature,model:e.chatModel,is_stream:!0},c=$t({role:"user",content:t});o&&i.value.messages.push(c);const _=$t({role:"assistant",streaming:!0,content:""});i.value.messages.push(_),u.value=!0,async function(e,t){const a=new AbortController;(null==t?void 0:t.onController)&&t.onController(a);const l=`${mt().bootstrap.api}/v1/chat/completions`;await D.post(l,e,{responseType:"stream",timeout:18e4,headers:{Accept:"application/json","Content-Type":"application/json"},signal:a.signal,onDownloadProgress(e){var a,l,o,r;200===(null==(l=null==(a=null==e?void 0:e.event)?void 0:a.target)?void 0:l.status)&&(null==t||t.onMessage(null==(r=null==(o=null==e?void 0:e.event)?void 0:o.target)?void 0:r.responseText,!1))}}).then((e=>{null==t||t.onMessage(null==e?void 0:e.data,!0)})).catch((e=>{var a;null==t||t.onError(e,null==(a=null==e?void 0:e.response)?void 0:a.status)}))}(s,{onController(e){a.value=e},onMessage(e,t){var a;if(d(_.id).content=e,l&&l(t),t&&(u.value=!1,d(_.id).streaming=!1,d(_.id).date=(new Date).valueOf(),!(null==(a=i.value)?void 0:a.topic))){const e=c.content.trim().replace(/\r/g,"");i.value.topic=e.length>30?e.slice(0,30):e}},onError(e,t){var a;u.value=!1,D.isCancel(e)||(401===t?d(_.id).content="请输入积分卡":d(_.id).content+=void 0!==t?`\n\n\`${(null==(a=null==e?void 0:e.response)?void 0:a.data)||"出错了，稍后重试吧"}\``:"\n\n`网络异常, 请稍后重试!`"),d(_.id).streaming=!1,d(_.id).isError=!0,d(_.id).date=(new Date).valueOf(),l&&l(!0)}})};return l((()=>{var e;u.value=!1,(null==(e=s.value)?void 0:e.length)<1?c():s.value.forEach((e=>{e.messages.forEach((e=>{e.streaming=!1}))}))})),{session:i,sessions:s,fetching:u,currentChat:r,abortController:a,newChatAction:c,clearSessions:()=>{var e,t;(null==(e=a.value)?void 0:e.abort)&&(null==(t=a.value)||t.abort()),h.warning({title:"操作提示",hideCancel:!1,alignCenter:!1,content:"是否确认移除所有会话信息, 此操作不可逆!!!",onOk(){s.value=[],c()}})},removeChatAction:e=>{h.warning({title:"操作提示",hideCancel:!1,alignCenter:!1,content:"是否确认移除当前选择会话?",onOk(){var t,l;const o=s.value.findIndex((t=>t.id===e));e!==r.value?s.value.splice(o,1):(s.value.length>1&&(r.value=s.value[0].id),s.value.splice(o,1),(null==(t=a.value)?void 0:t.abort)&&(null==(l=a.value)||l.abort()),0===s.value.length&&c())}})},sendMessageAction:_,messageRetryAction:(e,t)=>{var a,l;null==(a=i.value)||a.messages.splice(e,1);const o=null==(l=i.value)?void 0:l.messages[e-1];_((null==o?void 0:o.content)||"",t,!1)},changeCurrentChatAction:e=>{var t,l,o,n;(null==(t=a.value)?void 0:t.abort)&&(null==(l=a.value)||l.abort()),null==(n=null==(o=i.value)?void 0:o.messages)||n.forEach((e=>e.streaming=!1)),r.value=e},handleChangeSessionTopicAction:e=>{var t;i.value.topic=e||(null==(t=i.value)?void 0:t.topic)||""}}}),{persist:{storage:localStorage}}),Bt=s({__name:"ChangeSessionTopic",setup(e){const a=t(!1),l=t(""),o=Ht(),r=()=>{o.handleChangeSessionTopicAction(l.value)},n=()=>{var e;l.value=(null==(e=o.session)?void 0:e.topic)||"新的聊天"};return(e,t)=>{const o=M,s=h;return i(),T(C,null,[d("div",{onClick:t[0]||(t[0]=e=>a.value=!0)},[U(e.$slots,"default")]),f(s,{onBeforeOpen:n,visible:_(a),"onUpdate:visible":t[2]||(t[2]=e=>v(a)?a.value=e:null),title:"修改会话标题","hide-cancel":"","modal-style":{"max-width":"80%"},onOk:r},{default:c((()=>[f(o,{"max-length":30,modelValue:_(l),"onUpdate:modelValue":t[1]||(t[1]=e=>v(l)?l.value=e:null),placeholder:"请输入当前会话标题"},null,8,["modelValue"])])),_:1},8,["visible"])],64)}}}),Nt={class:"h-full flex flex-col items-stretch overflow-hidden"},Gt={class:"h-14 flex items-center px-2 gap-x-2 bg-white dark:bg-dark"},Ft={class:"flex-1 truncate"},qt={class:"flex items-center justify-between p-4 bg-white dark:bg-dark text-sm"},Kt=St(s({__name:"MessageList",props:{isDrawer:Boolean},setup(e){const t=it(),{isMobileScreen:a}=st(),l=Ht(),o=e=>{t.toggleCollapsedAction(!1),l.changeCurrentChatAction(String(e))},r=(e,a)=>{({newChat(){l.newChatAction(),t.toggleCollapsedAction(!1)},close(){t.toggleCollapsedAction(!1)},editor(){w.info("编辑")},del(){l.removeChatAction(a)}})[e]()};return(n,s)=>{const v=S("icon-plus"),m=g,h=S("icon-close"),w=W,y=S("icon-close-circle"),O=S("icon-edit"),k=Bt,E=F,A=q,x=$,P=H,M=W,I=Tt,z=S("icon-robot-add"),V=B,D=N;return i(),T(C,null,[f(D,{width:200,class:"chat-message_list"},{default:c((()=>[d("div",Nt,[d("div",Gt,[f(m,{class:"flex-1",type:"primary",onClick:s[0]||(s[0]=e=>r("newChat"))},{icon:c((()=>[f(v)])),default:c((()=>[b(" New Chat ")])),_:1}),_(a)?(i(),u(m,{key:0,onClick:s[1]||(s[1]=e=>r("close"))},{icon:c((()=>[f(h)])),_:1})):j("",!0)]),f(w,{class:"m-0"}),f(P,{"outer-style":"flex: 1; overflow: hidden;",class:"overflow-y-auto h-full px-0 flex flex-col gap-y-2"},{default:c((()=>[f(x,{"default-open-keys":["0"],"default-selected-keys":["0_1"],"selected-keys":[_(l).currentChat],onMenuItemClick:o},{default:c((()=>[(i(!0),T(C,null,L(_(l).sessions,(e=>(i(),u(A,{class:"chat-item",key:e.id},{default:c((()=>[d("span",Ft,p(e.topic||"新的聊天"),1),f(E,{size:"mini",class:"actions"},{default:c((()=>[f(m,{onClick:G((t=>r("del",e.id)),["stop"]),class:"flex items-center justify-center"},{icon:c((()=>[f(y,{class:"m-0"})])),_:2},1032,["onClick"]),f(k,null,{default:c((()=>[f(m,{class:"flex items-center justify-center"},{icon:c((()=>[f(O,{class:"m-0"})])),_:1})])),_:1})])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["selected-keys"])])),_:1}),f(M,{class:"my-2"}),f(I,{class:"is-chat"}),d("div",qt,[f(V,{type:"primary",onClick:_(l).clearSessions},{icon:c((()=>[f(z)])),default:c((()=>[b(" 清除会话 ")])),_:1},8,["onClick"]),f(V,{onClick:s[2]||(s[2]=()=>_(t).changeShowContactAction(!0)),type:"primary"},{icon:c((()=>[f(z)])),default:c((()=>[b(" 加入群聊 ")])),_:1})])])])),_:1}),e.isDrawer?j("",!0):(i(),u(w,{key:0,class:"m-0 h-full",direction:"vertical"}))],64)}}}),[["__scopeId","data-v-7184c3bf"]]),Yt=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"})),Jt=s({__name:"MessageListDrawer",setup:e=>(e,t)=>{const a=K;return i(),u(a,{width:"100%","hide-cancel":"",placement:"left",header:!1,footer:!1,class:"message-drawer","drawer-style":{maxWidth:"350px"}},{default:c((()=>[f(Kt,{"is-drawer":""})])),_:1})}}),Qt={class:"max-w-4xl w-full mx-auto"},Xt={class:"setting-card dark:bg-dark"},Zt={class:"text-primary"},ea={class:"setting-card dark:bg-dark"},ta={class:"setting-card dark:bg-dark"},aa={class:"setting-card dark:bg-dark"},la={class:"flex flex-wrap gap-y-2 items-center"},oa={class:"font-medium pl-4 text-primary"},ra=s({__name:"SettingsView",setup(e){const t=mt(),a={light:"浅色模式",dark:"深色模式",auto:"跟随系统"},l=it(),{isMobileScreen:o}=st(),r=e=>{l.changeModeAction(e)};return(e,n)=>{const s=Y,b=Ot,v=Et,m=J,g=Q,h=S("icon-sun"),w=X,y=S("icon-moon"),T=S("icon-relation"),C=Z,O=ee,k=H;return i(),u(k,{"outer-style":"flex: 1; overflow: hidden;","outer-class":["settings-wrapper",{"is-mobile":_(o)}],class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2"},{default:c((()=>[d("div",Qt,[f(O,{ref:"formRef","label-col-props":{span:12},"label-align":"left",model:{},class:"w-full mt-0 flex flex-col gap-y-3"},{default:c((()=>[d("div",Xt,[f(s,{"label-col-flex":"1","label-attrs":{align:"left"},class:"mb-0 font-medium pl-4 dark:text-light-900 nowrap",field:"theme",label:"Version"},{default:c((()=>[d("span",Zt,"v"+p(_("1.0.0")),1)])),_:1})]),d("div",ea,[f(s,{class:"mb-0",field:"card",label:"积分卡"},{default:c((()=>[f(b,{class:"w-full"})])),_:1})]),d("div",ta,[f(s,{class:"mb-0",field:"modelConfig.model",label:"模型(Model)"},{default:c((()=>[f(v,{class:"w-full"})])),_:1}),f(s,{class:"mb-0",field:"modelConfig.temperature",label:_(o)?"随机性 (temperature)":`随机性 (temperature): ${_(t).temperature}`},{default:c((()=>[_(o)?(i(),u(m,{key:0,max:2,step:.1,min:.1,precision:.1,"model-value":_(t).temperature,onChange:_(t).changeTemperatureAction,mode:"button"},null,8,["step","min","precision","model-value","onChange"])):(i(),u(g,{key:1,"model-value":_(t).temperature,onChange:_(t).changeTemperatureAction,step:.1,min:.1,max:2},null,8,["model-value","onChange","step","min"]))])),_:1},8,["label"])]),d("div",aa,[f(s,{class:"mb-0",field:"theme",label:"主题"},{default:c((()=>[d("div",la,[f(C,{"model-value":_(l).themeMode,type:"button",onChange:r},{default:c((()=>[f(w,{value:"light"},{default:c((()=>[f(h)])),_:1}),f(w,{value:"dark"},{default:c((()=>[f(y)])),_:1}),f(w,{value:"auto"},{default:c((()=>[f(T)])),_:1})])),_:1},8,["model-value"]),d("span",oa,p(a[_(l).themeMode]),1)])])),_:1}),j("",!0)])])),_:1},512)])])),_:1},8,["outer-class"])}}}),na=s({__name:"SettingDrawer",setup(e){const a=t(!1);return(e,t)=>{const l=g,o=K;return i(),T(C,null,[f(l,{onClick:t[0]||(t[0]=G((e=>a.value=!0),["stop"]))},{default:c((()=>[b("系统设置")])),_:1}),f(o,{visible:_(a),"onUpdate:visible":t[1]||(t[1]=e=>v(a)?a.value=e:null),width:"100%","render-to-body":!1,class:"settings-drawer",title:"设置中心","cancel-text":"关闭","drawer-style":{maxWidth:"500px"}},{default:c((()=>[f(ra)])),_:1},8,["visible"])],64)}}}),sa=["alt"],ia={class:"text-base m-0"},ua=(e=>(ie("data-v-5504ac25"),e=e(),ue(),e))((()=>d("i",{class:"flex-1"},null,-1))),ca=St(s({__name:"App",setup(e){const{VITE_FEATURES:a}={VITE_BASE_URL:"/",VITE_APP_TITLE:"AI 2023",VITE_PORT:"3000",VITE_DROP_CONSOLE:"true",VITE_FEATURES:"CHAT",VITE_WECHAT_URL:"/WeChat.png",VITE_E_WECHAT_URL:"/E-WeChat.jpg",VITE_DEBUG:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},l=ae(),o=le(),{isMobileScreen:r}=st(),n=y((()=>l.name)),s=t(!1),m=it(),h=e=>{try{o.push({name:e})}catch(t){w.error("路由未实现~")}},O=e=>{s.value=!1,o.push(e)};return(e,t)=>{const o=S("icon-menu"),w=g,y=S("RouterLink"),k=S("icon-message"),E=q,A=S("icon-pen-fill"),x=S("icon-apps"),P=S("icon-question-circle"),M=$,I=S("icon-right"),L=Et,z=Ot,V=oe,D=S("icon-more"),R=Tt,U=re,H=ne,B=W,N=S("RouterView"),G=se,F=bt;return i(),T(C,null,[f(G,{class:"w-full h-full bg-[var(--color-neutral-1)]"},{default:c((()=>{var g;return[f(H,{class:te(["h-14 flex items-center bg-white dark:bg-dark pr-2",{"pl-2":!(null==(g=e.$route.meta)?void 0:g.hideLogoText)&&_(r)}])},{default:c((()=>{var g,S;return[!(null==(g=e.$route.meta)?void 0:g.hideLogoText)&&_(r)?(i(),u(w,{key:0,onClick:_(m).toggleCollapsedAction},{icon:c((()=>[f(o)])),_:1},8,["onClick"])):j("",!0),f(y,{to:"/",class:te(["header-logo",[{"is-mobile":_(r)},(null==(S=e.$route.meta)?void 0:S.hideLogoText)?"justify-start pl-4":"justify-center"]])},{default:c((()=>[d("img",{class:"w-8 h-8 mr-2",src:At,alt:"APP_TITLE"in e?e.APP_TITLE:_(tt)},null,8,sa),d("h1",ia,p("APP_TITLE"in e?e.APP_TITLE:_(tt)),1)])),_:1},8,["class"]),_(r)?j("",!0):(i(),u(M,{key:1,onMenuItemClick:h,mode:"horizontal","selected-keys":[_(n)],class:"header-menu"},{default:c((()=>[_(a).includes("CHAT")?(i(),u(E,{key:"Chat",class:"ml-auto"},{icon:c((()=>[f(k)])),default:c((()=>[b(" 聊天 ")])),_:1})):j("",!0),_(a).includes("DRAW")?(i(),u(E,{key:"Draw"},{icon:c((()=>[f(A)])),default:c((()=>[b(" 绘图 ")])),_:1})):j("",!0),_(a).includes("TOOLS")?(i(),u(E,{key:"Tools"},{icon:c((()=>[f(x)])),default:c((()=>[b(" 工具 ")])),_:1})):j("",!0),f(E,{key:"Tutorial"},{icon:c((()=>[f(P)])),default:c((()=>[b(" 使用说明 ")])),_:1}),f(w,{class:"cursor-pointer",type:"text",target:"_blank",href:"https://www.houfaka.com/links/82105BDE"},{default:c((()=>[b(" 购买积分卡 ")])),_:1})])),_:1},8,["selected-keys"])),ua,_(r)||_(l).meta.hideSetup?j("",!0):(i(),u(V,{key:2,class:"mr-2"},{default:c((()=>[f(w,{class:"px-1",onClick:_(m).toggleHeaderCollapsedAction},{default:c((()=>[f(I,{class:te(["header-collapsed",{"is-collapsed":!_(m).headerSettingCollapsed}])},null,8,["class"])])),_:1},8,["onClick"]),d("div",{class:te(["flex flex-nowrap overflow-hidden transition-all",_(m).headerSettingCollapsed?"Draw"!==e.$route.name?"w-[28.5rem]":"w-60":"w-0"])},["Draw"!==e.$route.name?(i(),u(L,{key:0,class:"w-48 mr-2"})):j("",!0),f(z,{class:"w-60"})],2)])),_:1})),f(U,{trigger:"click","popup-visible":_(s),"onUpdate:popupVisible":t[3]||(t[3]=e=>v(s)?s.value=e:null),"content-class":"mr-2"},{content:c((()=>["Chat"!==_(l).name||_(r)?(i(),u(R,{key:0})):j("",!0),d("div",{class:te(["grid gap-3 grid-cols-2",_(r)?"grid-cols-2":"grid-cols-1"])},[_(r)?(i(),T(C,{key:0},["Chat"!==_(l).name?(i(),u(w,{key:0,onClick:t[0]||(t[0]=e=>O("chat"))},{default:c((()=>[b(" 聊天 ")])),_:1})):j("",!0),"Tutorial"!==_(l).name?(i(),u(w,{key:1,onClick:t[1]||(t[1]=e=>O("/tutorial"))},{default:c((()=>[b(" 使用说明 ")])),_:1})):j("",!0),f(w,{target:"_blank",href:"https://www.houfaka.com/links/82105BDE"},{default:c((()=>[b(" 购买积分卡 ")])),_:1})],64)):j("",!0),f(na),"About"!==_(l).name?(i(),u(w,{key:1,onClick:t[2]||(t[2]=e=>O("/about"))},{default:c((()=>[b(" 关于我们 ")])),_:1})):j("",!0)],2)])),default:c((()=>[f(w,null,{default:c((()=>[f(D)])),_:1})])),_:1},8,["popup-visible"])]})),_:1},8,["class"]),f(B,{class:"m-0"}),f(G,{class:"flex-1 overflow-hidden relative"},{default:c((()=>[_(r)?j("",!0):(i(),u(N,{key:0,name:"sider"})),f(G,{class:"flex-1 overflow-hidden"},{default:c((()=>[f(N)])),_:1})])),_:1})]})),_:1}),f(Jt,{visible:_(m).collapsed,"onUpdate:visible":t[4]||(t[4]=e=>_(m).collapsed=e)},null,8,["visible"]),f(Ut),f(F)],64)}}}),[["__scopeId","data-v-5504ac25"]]),da=(e,t)=>{const a=t.value,l=new Date(a),o=`${l.getFullYear()}-${("0"+(l.getMonth()+1)).slice(-2)}-${("0"+l.getDate()).slice(-2)} ${("0"+l.getHours()).slice(-2)}:${("0"+l.getMinutes()).slice(-2)}:${("0"+l.getSeconds()).slice(-2)}`;e.textContent=o},_a={mounted:da,updated:da},pa=(e,t)=>{const{value:a}=t,l=it(),o=ce({size:200,padding:16,data:a,background:"dark"===l.themeMode?"#232324":"#999999",foreground:"dark"===l.themeMode?"#f4f4f4":"#000000"});e.innerHtml="",e.appendChild(o)},fa={mounted:pa,updated:pa},ba={},va=function(e,t,a){if(!t||0===t.length)return e();const l=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in ba)return;ba[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(!!a)for(let a=l.length-1;a>=0;a--){const o=l[a];if(o.href===e&&(!t||"stylesheet"===o.rel))return}else if(document.querySelector(`link[href="${e}"]${o}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))},{VITE_FEATURES:ma}={VITE_BASE_URL:"/",VITE_APP_TITLE:"AI 2023",VITE_PORT:"3000",VITE_DROP_CONSOLE:"true",VITE_FEATURES:"CHAT",VITE_WECHAT_URL:"/WeChat.png",VITE_E_WECHAT_URL:"/E-WeChat.jpg",VITE_DEBUG:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},ga=[{path:"/",name:"Home",components:{default:()=>va((()=>import("./HomeView-e9ec291d.js")),["static/js/HomeView-e9ec291d.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css","static/css/HomeView-a924b347.css"])},meta:{hideSetup:!0,hideLogoText:!0}},{path:"/tutorial",name:"Tutorial",component:()=>va((()=>import("./TutorialView-ce453e19.js")),["static/js/TutorialView-ce453e19.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css"])},{path:"/about",name:"About",component:()=>va((()=>import("./AboutView-ec34ddf5.js")),["static/js/AboutView-ec34ddf5.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css","static/css/AboutView-f82bf448.css"])}];ma.includes("CHAT")&&ga.push({path:"/chat",name:"Chat",components:{sider:()=>va((()=>Promise.resolve().then((()=>Yt))),void 0),default:()=>va((()=>import("./ChatView-16e85d3b.js")),["static/js/ChatView-16e85d3b.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css","static/css/ChatView-876098da.css"])}}),ma.includes("TOOLS")&&ga.push({path:"/tools",name:"Tools",component:()=>va((()=>import("./ToolsView-2fb878ef.js")),["static/js/ToolsView-2fb878ef.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css","static/css/ToolsView-5828883b.css"])}),ma.includes("DRAW")&&ga.push({path:"/draw",name:"Draw",component:()=>va((()=>import("./DrawView-a1ddafd5.js")),["static/js/DrawView-a1ddafd5.js","static/js/.pnpm-22857cbc.js","static/css/.pnpm-dcab1434.css","static/css/DrawView-e9eb73f3.css"])});const ha=de({history:_e("/"),routes:ga}),wa=pe();wa.use(fe);const ya=be(ca);var Sa;ya.use(wa),ya.use(ha),ya.use(ve),(Sa=ya).directive("qr",fa),Sa.directive("date-time",_a),ya.mount("#app");export{tt as A,nt as D,at as E,rt as I,vt as S,At as _,e as __vite_legacy_guard,St as a,Ht as b,st as c,Fe as d,mt as u};
