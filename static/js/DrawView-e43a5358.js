import{o as a,as as e,d as l,r as s,M as t,c as o,at as d,e as n,au as r,f as u,am as i,g as c,h as m,i as p,k as f,j as x,m as g,l as b,x as v,u as _,F as w,_ as y,s as h,av as V,aw as k,ax as z,B as A,ay as D,X as U,U as j,Z as C,az as E,aA as S,aB as I,J as T,t as B,ap as F,aC as L,y as M,T as O,aD as R,aE as G,aF as J,aG as P}from"./.pnpm-209fcd37.js";import{d as W,r as X,e as Z,D as $,a as q}from"./index-e7c826f8.js";const H=l("__AI_1024_STORE_DRAW",(()=>{const e=W(),l=s(!1),o=s([]);a((()=>{}));return{draws:o,loading:l,imageDrawAction:a=>{l.value=!0,X({...a,card:e.card},{onController(a){},onSuccess(e){l.value=!1,o.value.push({prompt:a.prompt,size:a.size,urls:e.data.map((a=>`data:image/png;base64, ${a.b64_json}`)),date:e.created})},onError(a){var e;l.value=!1,t.error(null!=(e=null==a?void 0:a.message)?e:"")}})}}}),{persist:{storage:localStorage,paths:["draws"]}}),K={class:"flex items-center gap-x-5"},N={class:"text-xs px-2 py-1"},Q={class:"flex flex-col gap-y-1 select-none"},Y=q(o({__name:"DrawView",setup(l){const{isMobileScreen:o}=Z(),W=d({prompt:"",size:"256x256",n:1,response_format:"b64_json"}),X=s(0),q=n((()=>V($,2)[X.value])),Y=()=>{const a=V($,2).length-1,e=X.value+1>a?0:X.value+1;X.value=e},aa=H(),ea=n((()=>aa.loading));(l=>{const s=a=>{l&&(a.returnValue="浏览器正在关闭或刷新页面！")};a((()=>{window.addEventListener("beforeunload",s)})),e((()=>{window.removeEventListener("beforeunload",s)}))})(ea),r((async()=>!ea.value||await new Promise(((a,e)=>{M.warning({title:"提示",okText:"离开",hideCancel:!1,content:"AI已经开始处理您的请求，此时刷新或离开页面，也会造成您的积分扣除，确定刷新或离开吗？",onOk(){a(!0)},onCancel(){e(!1)}})}))));const la=()=>{W.prompt.trim().length<1?t.error("关键词不能为空"):aa.imageDrawAction(W)},sa=n((()=>aa.draws));return(a,e)=>{const l=u("icon-exclamation-circle-fill"),s=k,t=z,d=u("icon-loop"),n=A,r=O,V=u("icon-robot"),M=D,X=U,Z=j,$=C,H=R,aa=G,ta=J,oa=P,da=E,na=S,ra=I,ua=T,ia=i("date-time");return c(),m(ua,{"outer-style":"flex: 1; overflow: hidden;",class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2"},{default:p((()=>[f("div",{class:y(["draw-view",{"is-mobile":_(o)}])},[x(s,{type:"info",class:"max-w-max mx-auto rounded-full text-xs"},{icon:p((()=>[x(l)])),default:p((()=>[g(" 根据输入关键词生成~大约需要30s左右时间 ")])),_:1}),f("div",K,[x(t,{class:"h-12 flex items-center",bold:""},{default:p((()=>[g(" 关键词示例 ")])),_:1}),x(n,{type:"text",size:"mini",onClick:Y},{default:p((()=>[x(d)])),_:1})]),(c(!0),b(w,null,v(_(q),(a=>(c(),b("div",{key:a.tag,class:"flex items-center gap-x-1 mb-2"},[f("mark",N,B(a.tag),1),x(r,{type:"secondary",copyable:"",class:"mb-0"},{default:p((()=>[g(B(a.keywords),1)])),_:2},1024)])))),128)),x(M,{loading:_(ea),class:"w-full mt-4",size:"large",autofocus:"",modelValue:_(W).prompt,"onUpdate:modelValue":e[0]||(e[0]=a=>_(W).prompt=a),placeholder:"请用中文输入关键词如上，参考形式: 画面主体，细节描述，修饰词","search-button":"",onSearch:la},{"button-icon":p((()=>[x(V)])),"button-default":p((()=>[g("生成")])),_:1},8,["loading","modelValue"]),x($,{model:_(W),class:y([{"is-mobile":_(o)},"mt-4 p-4 bg-light-300 dark:bg-dark-900 rounded"]),"label-col-props":{span:_(o)?24:void 0},"auto-label-width":!_(o),"label-align":"left"},{default:p((()=>[x(t,{class:"block",bold:""},{default:p((()=>[g(" 参数设置 ")])),_:1}),x(Z,{label:"图片尺寸",class:"mb-2"},{default:p((()=>[f("div",{class:y(["w-full",{"grid grid-cols-2 gap-y-2":_(o)}])},[x(X,{class:"min-w-max",modelValue:_(W).size,"onUpdate:modelValue":e[1]||(e[1]=a=>_(W).size=a),type:"button",value:"256x256"},{default:p((()=>[g(" 256x256(小图) ")])),_:1},8,["modelValue"]),x(X,{class:"min-w-max",modelValue:_(W).size,"onUpdate:modelValue":e[2]||(e[2]=a=>_(W).size=a),type:"button",value:"512x512"},{default:p((()=>[g(" 512x512(中图) ")])),_:1},8,["modelValue"]),x(X,{class:"min-w-max",modelValue:_(W).size,"onUpdate:modelValue":e[3]||(e[3]=a=>_(W).size=a),type:"button",value:"1024x1024"},{default:p((()=>[g(" 1024x1024(大图) ")])),_:1},8,["modelValue"])],2)])),_:1}),x(Z,{help:"每张图片 20 积分","validate-status":"warning",label:"图片数量",class:"mb-2"},{default:p((()=>[f("div",{class:y(["w-full",{"grid grid-cols-5 gap-y-2":_(o)}])},[(c(),b(w,null,v(10,(a=>x(X,{class:"min-w-max",modelValue:_(W).n,"onUpdate:modelValue":e[4]||(e[4]=a=>_(W).n=a),type:"button",key:a,value:a},{default:p((()=>[g(B(a)+"张 ",1)])),_:2},1032,["modelValue","value"]))),64))],2)])),_:1})])),_:1},8,["model","class","label-col-props","auto-label-width"]),_(sa).length?(c(),m(ra,{key:0,class:"mt-6",type:"capsule"},{default:p((()=>[x(na,{key:"1",title:"我的作品"},{default:p((()=>[x(da,{"default-active-key":[1],accordion:""},{default:p((()=>[(c(!0),b(w,null,v(_(sa).reverse(),(a=>(c(),m(oa,{key:a.date},{extra:p((()=>[x(H,{color:"red",size:"small"},{default:p((()=>[g(B(a.urls.length)+"张",1)])),_:2},1024)])),header:p((()=>[f("div",Q,[x(r,{class:"mb-0",ellipsis:{rows:1,expandable:!0}},{default:p((()=>[g(B(a.prompt),1)])),_:2},1024),F(f("small",{style:L({color:"var(--color-text-3)"})},null,4),[[ia,1e3*a.date]])])])),default:p((()=>[x(ta,{infinite:""},{default:p((()=>[f("div",{class:y(["grid gap-3",[_(o)?"grid-cols-2":"grid-cols-5"]])},[(c(!0),b(w,null,v(a.urls,(a=>(c(),m(aa,{key:a,src:a},null,8,["src"])))),128))],2)])),_:2},1024),x(s,{type:"info",class:"max-w-max mx-auto rounded-full text-xs my-4"},{icon:p((()=>[x(l)])),default:p((()=>[g(" 尺寸: "+B(a.size),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):h("",!0)],2)])),_:1})}}}),[["__scopeId","data-v-6a846abb"]]);export{Y as default};
