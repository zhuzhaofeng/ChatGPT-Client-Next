System.register(["./.pnpm-legacy-d3ec3afe.js","./index-legacy-5d9f131b.js"],(function(a,e){"use strict";var t,o,l,r,s,n,i,d,c,u,m,p,w,b,f,g,v,x,y,h,_,k,V,E,z,j,S,C,A,T,D,U,I,O,$,B,F,L,M,P,R,q,G,H,J,K,N,W,Y,Q=document.createElement("style");return Q.textContent=".draw-view[data-v-6a846abb]{--tw-bg-opacity: 1 !important;background-color:rgba(255,255,255,var(--tw-bg-opacity))!important;border-radius:.5rem!important;margin-left:auto!important;margin-right:auto!important;max-width:56rem!important;padding:2.5rem!important;--tw-shadow: 0 10px 15px -3px rgb(0 0 0/.1),0 4px 6px -4px rgb(0 0 0/.1) !important;--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color) !important;-webkit-box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;width:100%!important}.dark .draw-view[data-v-6a846abb]{--tw-bg-opacity: 1 !important;background-color:rgba(35,35,36,var(--tw-bg-opacity))!important}.draw-view.is-mobile[data-v-6a846abb]{padding:1rem!important}.draw-view.is-mobile[data-v-6a846abb] .arco-radio-button:before{display:none}.draw-view[data-v-6a846abb] .arco-tabs-nav-tab{-webkit-box-pack:start!important;-ms-flex-pack:start!important;-webkit-justify-content:flex-start!important;justify-content:flex-start!important}.draw-view[data-v-6a846abb] .arco-tabs-nav-tab .arco-tabs-nav-tab-list{width:auto!important}.draw-view[data-v-6a846abb] .arco-image{width:100%!important}.draw-view[data-v-6a846abb] .arco-image .arco-image-img{-o-object-fit:cover!important;object-fit:cover!important;width:100%!important}\n",document.head.appendChild(Q),{setters:[a=>{t=a.o,o=a.at,l=a.d,r=a.r,s=a.M,n=a.c,i=a.au,d=a.e,c=a.av,u=a.f,m=a.an,p=a.g,w=a.h,b=a.i,f=a.k,g=a.j,v=a.m,x=a.l,y=a.x,h=a.u,_=a.F,k=a.$,V=a.s,E=a.aw,z=a.ax,j=a.ay,S=a.B,C=a.az,A=a.Y,T=a.V,D=a._,U=a.aA,I=a.aB,O=a.aC,$=a.K,B=a.t,F=a.aq,L=a.aD,M=a.y,P=a.T,R=a.aE,q=a.aF,G=a.aG,H=a.aH},a=>{J=a.d,K=a.I,N=a.e,W=a.D,Y=a.a}],execute:function(){const e=l("__AI_1024_STORE_DRAW",(()=>{const a=J(),e=r(!1),o=r([]);return t((()=>{})),{draws:o,loading:e,imageDrawAction:t=>{e.value=!0,async function(a,e){const t=new AbortController,o=setTimeout((()=>t.abort()),3e5);try{const l=`${J().bootstrap.api}${K}`,r=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:t.signal});if(clearTimeout(o),r.ok){const a=await r.json();500===a.code?e?.onError(new Error(a.msg),a.code):e?.onSuccess(a)}else if(401===r.status)e?.onError(new Error("Anauthorized"),r.status);else if(500===r.status){const a=await r.json();e?.onError(new Error(a),r.status)}else e?.onError(new Error("Stream Error"),r.status)}catch(l){e?.onError(l)}}({...t,card:a.card},{onController(a){},onSuccess(a){e.value=!1,o.value.push({prompt:t.prompt,size:t.size,urls:a.data.map((a=>`data:image/png;base64, ${a.b64_json}`)),date:a.created})},onError(a){e.value=!1,s.error(a?.message??"")}})}}}),{persist:{storage:localStorage,paths:["draws"]}}),Q={class:"flex items-center gap-x-5"},X={class:"text-xs px-2 py-1"},Z={class:"flex flex-col gap-y-1 select-none"};a("default",Y(n({__name:"DrawView",setup(a){const{isMobileScreen:l}=N(),n=i({prompt:"",size:"256x256",n:1,response_format:"b64_json"}),J=r(0),K=d((()=>E(W,2)[J.value])),Y=()=>{const a=E(W,2).length-1,e=J.value+1>a?0:J.value+1;J.value=e},aa=e(),ea=d((()=>aa.loading));(a=>{const e=e=>{a&&(e.returnValue="浏览器正在关闭或刷新页面！")};t((()=>{window.addEventListener("beforeunload",e)})),o((()=>{window.removeEventListener("beforeunload",e)}))})(ea),c((async()=>!ea.value||await new Promise(((a,e)=>{M.warning({title:"提示",okText:"离开",hideCancel:!1,content:"AI已经开始处理您的请求，此时刷新或离开页面，也会造成您的积分扣除，确定刷新或离开吗？",onOk(){a(!0)},onCancel(){e(!1)}})}))));const ta=()=>{n.prompt.trim().length<1?s.error("关键词不能为空"):aa.imageDrawAction(n)},oa=d((()=>aa.draws));return(a,e)=>{const t=u("icon-exclamation-circle-fill"),o=z,r=j,s=u("icon-loop"),i=S,d=P,c=u("icon-robot"),E=C,M=A,J=T,N=D,W=R,aa=q,la=G,ra=H,sa=U,na=I,ia=O,da=$,ca=m("date-time");return p(),w(da,{"outer-style":"flex: 1; overflow: hidden;",class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2"},{default:b((()=>[f("div",{class:k(["draw-view",{"is-mobile":h(l)}])},[g(o,{type:"info",class:"max-w-max mx-auto rounded-full text-xs"},{icon:b((()=>[g(t)])),default:b((()=>[v(" 根据输入关键词生成~大约需要30s左右时间 ")])),_:1}),f("div",Q,[g(r,{class:"h-12 flex items-center",bold:""},{default:b((()=>[v(" 关键词示例 ")])),_:1}),g(i,{type:"text",size:"mini",onClick:Y},{default:b((()=>[g(s)])),_:1})]),(p(!0),x(_,null,y(h(K),(a=>(p(),x("div",{key:a.tag,class:"flex items-center gap-x-1 mb-2"},[f("mark",X,B(a.tag),1),g(d,{type:"secondary",copyable:"",class:"mb-0"},{default:b((()=>[v(B(a.keywords),1)])),_:2},1024)])))),128)),g(E,{loading:h(ea),class:"w-full mt-4",size:"large",autofocus:"",modelValue:h(n).prompt,"onUpdate:modelValue":e[0]||(e[0]=a=>h(n).prompt=a),placeholder:"请用中文输入关键词如上，参考形式: 画面主体，细节描述，修饰词","search-button":"",onSearch:ta},{"button-icon":b((()=>[g(c)])),"button-default":b((()=>[v("生成")])),_:1},8,["loading","modelValue"]),g(N,{model:h(n),class:k([{"is-mobile":h(l)},"mt-4 p-4 bg-light-300 dark:bg-dark-900 rounded"]),"label-col-props":{span:h(l)?24:void 0},"auto-label-width":!h(l),"label-align":"left"},{default:b((()=>[g(r,{class:"block",bold:""},{default:b((()=>[v(" 参数设置 ")])),_:1}),g(J,{label:"图片尺寸",class:"mb-2"},{default:b((()=>[f("div",{class:k(["w-full",{"grid grid-cols-2 gap-y-2":h(l)}])},[g(M,{class:"min-w-max",modelValue:h(n).size,"onUpdate:modelValue":e[1]||(e[1]=a=>h(n).size=a),type:"button",value:"256x256"},{default:b((()=>[v(" 256x256(小图) ")])),_:1},8,["modelValue"]),g(M,{class:"min-w-max",modelValue:h(n).size,"onUpdate:modelValue":e[2]||(e[2]=a=>h(n).size=a),type:"button",value:"512x512"},{default:b((()=>[v(" 512x512(中图) ")])),_:1},8,["modelValue"]),g(M,{class:"min-w-max",modelValue:h(n).size,"onUpdate:modelValue":e[3]||(e[3]=a=>h(n).size=a),type:"button",value:"1024x1024"},{default:b((()=>[v(" 1024x1024(大图) ")])),_:1},8,["modelValue"])],2)])),_:1}),g(J,{help:"每张图片 20 积分","validate-status":"warning",label:"图片数量",class:"mb-2"},{default:b((()=>[f("div",{class:k(["w-full",{"grid grid-cols-5 gap-y-2":h(l)}])},[(p(),x(_,null,y(10,(a=>g(M,{class:"min-w-max",modelValue:h(n).n,"onUpdate:modelValue":e[4]||(e[4]=a=>h(n).n=a),type:"button",key:a,value:a},{default:b((()=>[v(B(a)+"张 ",1)])),_:2},1032,["modelValue","value"]))),64))],2)])),_:1})])),_:1},8,["model","class","label-col-props","auto-label-width"]),h(oa).length?(p(),w(ia,{key:0,class:"mt-6",type:"capsule"},{default:b((()=>[g(na,{key:"1",title:"我的作品"},{default:b((()=>[g(sa,{"default-active-key":[1],accordion:""},{default:b((()=>[(p(!0),x(_,null,y(h(oa).reverse(),(a=>(p(),w(ra,{key:a.date},{extra:b((()=>[g(W,{color:"red",size:"small"},{default:b((()=>[v(B(a.urls.length)+"张",1)])),_:2},1024)])),header:b((()=>[f("div",Z,[g(d,{class:"mb-0",ellipsis:{rows:1,expandable:!0}},{default:b((()=>[v(B(a.prompt),1)])),_:2},1024),F(f("small",{style:L({color:"var(--color-text-3)"})},null,4),[[ca,1e3*a.date]])])])),default:b((()=>[g(la,{infinite:""},{default:b((()=>[f("div",{class:k(["grid gap-3",[h(l)?"grid-cols-2":"grid-cols-5"]])},[(p(!0),x(_,null,y(a.urls,(a=>(p(),w(aa,{key:a,src:a},null,8,["src"])))),128))],2)])),_:2},1024),g(o,{type:"info",class:"max-w-max mx-auto rounded-full text-xs my-4"},{icon:b((()=>[g(t)])),default:b((()=>[v(" 尺寸: "+B(a.size),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):V("",!0)],2)])),_:1})}}}),[["__scopeId","data-v-6a846abb"]]))}}}));
