import{g as ae,R as Be,I as Je,h as Qe,t as Ie,i as ve,u as Xe,r as C,j as k,k as Ye,l as fe,m as Ze,n as et,q as Z,s as Te,v as Pe,x as tt,y as Fe,z as ze,A as ot,C as Re,D as F,o as h,E as T,F as L,G as nt,H as Q,J as X,b as u,w as I,a as W,K as te,L as we,M as at,N as lt,O as st,P as Ke,T as qe,Q as rt,U as it,V as ut,W as dt,c as ee,X as xe,d as ke,Y as pt,Z as _e,$ as We,a0 as ct,a1 as ft,a2 as Oe,a3 as Ne,a4 as Ue,a5 as vt,a6 as yt,a7 as ht,a8 as P,_ as mt,a9 as gt,aa as bt,ab as Ct,ac as wt,ad as Ve,ae as Me,af as Ae,ag as xt,ah as _t,ai as kt,aj as Tt,ak as St,S as Et,al as $t,am as Se,an as Bt,ao as Rt,ap as It}from"./index-a17ea8b9.js";import{M as Pt,H as Ce,m as zt,a as Ot}from"./index-b7903ef7.js";import{D as Nt,a as Vt}from"./dropdown-button-21da0230.js";const Mt=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],At=e=>{const t={};return Mt.forEach(o=>{t[o]=e.getPropertyValue(o)}),t},Ht=ae({name:"Textarea",components:{ResizeObserver:Be,IconHover:Je,IconClose:Qe},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:o}){const{disabled:s,error:c,modelValue:f}=Ie(e),l=ve("textarea"),{mergedDisabled:r,mergedError:i,eventHandlers:a}=Xe({disabled:s,error:c}),m=C(),M=C(),K=C(),p=C(),S=C(e.defaultValue),y=k(()=>{var n;return(n=f.value)!=null?n:S.value}),[_,O]=Ye(m);fe(f,n=>{(Ze(n)||et(n))&&(S.value="")});const z=k(()=>Z(e.maxLength)&&!!e.maxLength.errorOnly),w=k(()=>Z(e.maxLength)?e.maxLength.length:e.maxLength),A=n=>{var v;return tt(e.wordLength)?e.wordLength(n):(v=n.length)!=null?v:0},j=k(()=>A(y.value)),oe=k(()=>i.value||!!(w.value&&z.value&&j.value>w.value)),B=C(!1),N=C(!1),le=k(()=>e.allowClear&&!r.value&&y.value),D=C(!1),V=C(""),U=()=>{_(),Re(()=>{m.value&&y.value!==m.value.value&&(m.value.value=y.value,O())})},$=(n,v=!0)=>{var b,g;w.value&&!z.value&&A(n)>w.value&&(n=(g=(b=e.wordSlice)==null?void 0:b.call(e,n,w.value))!=null?g:n.slice(0,w.value)),S.value=n,v&&t("update:modelValue",n),U()};let G=y.value;const ne=(n,v)=>{var b,g;n!==G&&(G=n,t("change",n,v),(g=(b=a.value)==null?void 0:b.onChange)==null||g.call(b,v))},R=n=>{var v,b;N.value=!0,G=y.value,t("focus",n),(b=(v=a.value)==null?void 0:v.onFocus)==null||b.call(v,n)},se=n=>{var v,b;N.value=!1,t("blur",n),(b=(v=a.value)==null?void 0:v.onBlur)==null||b.call(v,n),ne(y.value,n)},E=n=>{var v,b;const{value:g}=n.target;if(n.type==="compositionend"){if(D.value=!1,V.value="",w.value&&!z.value&&y.value.length>=w.value&&A(g)>w.value){U();return}t("input",g,n),$(g),(b=(v=a.value)==null?void 0:v.onInput)==null||b.call(v,n)}else D.value=!0},J=n=>{var v,b;const{value:g}=n.target;if(D.value)V.value=g;else{if(w.value&&!z.value&&y.value.length>=w.value&&A(g)>w.value&&n.inputType==="insertText"){U();return}t("input",g,n),$(g),(b=(v=a.value)==null?void 0:v.onInput)==null||b.call(v,n)}},ye=n=>{$(""),ne("",n),t("clear",n)};fe(f,n=>{n!==y.value&&$(n!=null?n:"",!1)});const de=n=>Fe(o,ze),re=n=>ot(o,ze),he=k(()=>[`${l}-wrapper`,{[`${l}-focus`]:N.value,[`${l}-disabled`]:r.value,[`${l}-error`]:oe.value,[`${l}-scroll`]:B.value}]);let me;const d=C(0),H=C(0),pe=k(()=>!Z(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*d.value+H.value),ce=k(()=>!Z(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*d.value+H.value),ie=()=>{const n=At(me);d.value=Number.parseInt(n["line-height"]||0,10),H.value=Number.parseInt(n["border-width"]||0,10)*2+Number.parseInt(n["padding-top"]||0,10)+Number.parseInt(n["padding-bottom"]||0,10),p.value=n,Re(()=>{var v;const b=(v=K.value)==null?void 0:v.offsetHeight;let g=b!=null?b:0,q="hidden";pe.value&&g<pe.value&&(g=pe.value),ce.value&&g>ce.value&&(g=ce.value,q="auto"),M.value={height:`${g}px`,resize:"none",overflow:q}})};Te(()=>{m.value&&(me=window.getComputedStyle(m.value),e.autoSize&&ie()),Y()});const ge=()=>{e.autoSize&&K.value&&ie(),Y()},be=n=>{m.value&&n.target!==m.value&&(n.preventDefault(),m.value.focus())},Y=()=>{m.value&&(m.value.scrollHeight>m.value.offsetHeight?B.value||(B.value=!0):B.value&&(B.value=!1))};return fe(y,()=>{e.autoSize&&K.value&&ie(),Y()}),{prefixCls:l,wrapperCls:he,textareaRef:m,textareaStyle:M,mirrorRef:K,mirrorStyle:p,computedValue:y,showClearBtn:le,valueLength:j,computedMaxLength:w,mergedDisabled:r,getWrapperAttrs:de,getTextareaAttrs:re,handleInput:J,handleFocus:R,handleBlur:se,handleComposition:E,handleClear:ye,handleResize:ge,handleMousedown:be}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),Lt=["disabled","value","placeholder"];function jt(e,t,o,s,c,f){const l=F("resize-observer"),r=F("icon-close"),i=F("icon-hover");return h(),T("div",te(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...a)=>e.handleMousedown&&e.handleMousedown(...a))}),[e.autoSize?(h(),T("div",{key:0,ref:"mirrorRef",class:L(`${e.prefixCls}-mirror`),style:nt(e.mirrorStyle)},Q(`${e.computedValue}
`),7)):X("v-if",!0),u(l,{onResize:e.handleResize},{default:I(()=>[W("textarea",te({ref:"textareaRef"},e.getTextareaAttrs(e.$attrs),{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...a)=>e.handleInput&&e.handleInput(...a)),onFocus:t[1]||(t[1]=(...a)=>e.handleFocus&&e.handleFocus(...a)),onBlur:t[2]||(t[2]=(...a)=>e.handleBlur&&e.handleBlur(...a)),onCompositionstart:t[3]||(t[3]=(...a)=>e.handleComposition&&e.handleComposition(...a)),onCompositionupdate:t[4]||(t[4]=(...a)=>e.handleComposition&&e.handleComposition(...a)),onCompositionend:t[5]||(t[5]=(...a)=>e.handleComposition&&e.handleComposition(...a))}),null,16,Lt)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(h(),T("div",{key:1,class:L(`${e.prefixCls}-word-limit`)},Q(e.valueLength)+"/"+Q(e.computedMaxLength),3)):X("v-if",!0),e.showClearBtn?(h(),T("div",{key:2,class:L(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...a)=>e.handleClear&&e.handleClear(...a))},[u(i,null,{default:I(()=>[u(r)]),_:1})],2)):X("v-if",!0)],16)}var Ee=Pe(Ht,[["render",jt]]);const Dt=Object.assign(Ee,{install:(e,t)=>{at(e,t);const o=lt(t);e.component(o+Ee.name,Ee)}}),Ft=ae({name:"TypographyEditContent",components:{Input:st},props:{text:{type:String,required:!0}},emits:["change","end","update:text"],setup(e,{emit:t}){const s=[`${ve("typography")}-edit-content`],c=C();function f(r){t("update:text",r),t("change",r)}function l(){t("end")}return Te(()=>{if(!c.value||!c.value.$el)return;const r=c.value.$el.querySelector("input");if(!r)return;r.focus&&r.focus();const{length:i}=r.value;r.setSelectionRange(i,i)}),{classNames:s,inputRef:c,onBlur:l,onChange:f,onEnd:l}}});function Kt(e,t,o,s,c,f){const l=F("Input");return h(),T("div",{class:L(e.classNames)},[u(l,{ref:"inputRef","auto-size":"","model-value":e.text,onBlur:e.onBlur,onInput:e.onChange,onKeydown:Ke(e.onEnd,["enter"])},null,8,["model-value","onBlur","onInput","onKeydown"])],2)}var qt=Pe(Ft,[["render",Kt]]);const Wt=ae({name:"TypographyOperations",components:{Tooltip:qe,IconCheckCircleFill:rt,IconCopy:it,IconEdit:ut},props:{editable:Boolean,copyable:Boolean,expandable:Boolean,isCopied:Boolean,isEllipsis:Boolean,expanded:Boolean,forceRenderExpand:Boolean,editTooltipProps:Object,copyTooltipProps:Object},emits:{edit:()=>!0,copy:()=>!0,expand:()=>!0},setup(e,{emit:t}){const o=ve("typography"),s=k(()=>e.forceRenderExpand||e.expandable&&e.isEllipsis),{t:c}=dt();return{prefixCls:o,showExpand:s,t:c,onEditClick(){t("edit")},onCopyClick(){t("copy")},onExpandClick(){t("expand")}}}});function Ut(e,t,o,s,c,f){const l=F("IconEdit"),r=F("Tooltip"),i=F("IconCheckCircleFill"),a=F("IconCopy");return h(),T(_e,null,[e.editable?(h(),ee(r,te({key:0,content:e.t("typography.edit")},e.editTooltipProps),{default:I(()=>[W("span",{class:L(`${e.prefixCls}-operation-edit`),onClick:t[0]||(t[0]=xe((...m)=>e.onEditClick&&e.onEditClick(...m),["stop"]))},[u(l)],2)]),_:1},16,["content"])):X("v-if",!0),e.copyable?(h(),ee(r,pt(te({key:1},e.copyTooltipProps)),{content:I(()=>[we(e.$slots,"copy-tooltip",{copied:e.isCopied},()=>[ke(Q(e.isCopied?e.t("typography.copied"):e.t("typography.copy")),1)])]),default:I(()=>[W("span",{class:L({[`${e.prefixCls}-operation-copied`]:e.isCopied,[`${e.prefixCls}-operation-copy`]:!e.isCopied}),onClick:t[1]||(t[1]=xe((...m)=>e.onCopyClick&&e.onCopyClick(...m),["stop"]))},[we(e.$slots,"copy-icon",{copied:e.isCopied},()=>[e.isCopied?(h(),ee(i,{key:0})):(h(),ee(a,{key:1}))])],2)]),_:3},16)):X("v-if",!0),e.showExpand?(h(),T("a",{key:2,class:L(`${e.prefixCls}-operation-expand`),onClick:t[2]||(t[2]=xe((...m)=>e.onExpandClick&&e.onExpandClick(...m),["stop"]))},[we(e.$slots,"expand-node",{expanded:e.expanded},()=>[ke(Q(e.expanded?e.t("typography.collapse"):e.t("typography.expand")),1)])],2)):X("v-if",!0)],64)}var He=Pe(Wt,[["render",Ut]]);let x;function Gt(e){return Array.prototype.slice.apply(e).map(o=>`${o}: ${e.getPropertyValue(o)};`).join("")}function $e(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var Jt=(e,t,o,s)=>{x||(x=document.createElement("div"),document.body.appendChild(x));const{rows:c,suffix:f,ellipsisStr:l}=t,r=window.getComputedStyle(e),i=Gt(r),a=$e(r.lineHeight),m=Math.round(a*c+$e(r.paddingTop)+$e(r.paddingBottom));x.setAttribute("style",i),x.setAttribute("aria-hidden","true"),x.style.height="auto",x.style.minHeight="auto",x.style.maxHeight="auto",x.style.position="fixed",x.style.left="0",x.style.top="-99999999px",x.style.zIndex="-200",x.style.whiteSpace="normal";const M=We({render(){return u("span",null,[o])}});M.mount(x);const K=Array.prototype.slice.apply(x.childNodes[0].cloneNode(!0).childNodes);M.unmount(),x.innerHTML="";const p=document.createTextNode(`${l}${f}`);x.appendChild(p),K.forEach(O=>{x.appendChild(O)});const S=document.createTextNode(s);x.insertBefore(S,p);function y(){return x.offsetHeight<=m}if(y())return{ellipsis:!1,text:s};function _(O,z=0,w=s.length,A=0){const j=Math.floor((z+w)/2),oe=s.slice(0,j);if(O.textContent=oe,z>=w-1)for(let B=w;B>=z;B-=1){const N=s.slice(0,B);if(O.textContent=N,y()||!N)return}y()?_(O,j,w,j):_(O,z,j,A)}return _(S),{text:S.textContent,ellipsis:!0}};const Qt=async e=>{var t;if((t=navigator.clipboard)!=null&&t.writeText)try{await navigator.clipboard.writeText(e);return}catch(f){console.error(f!=null?f:new DOMException("The request is not allowed","NotAllowedError"))}const o=document.createElement("span");o.textContent=e,o.style.whiteSpace="pre",document.body.appendChild(o);const s=window.getSelection(),c=window.document.createRange();s==null||s.removeAllRanges(),c.selectNode(o),s==null||s.addRange(c);try{window.document.execCommand("copy")}catch(f){console.error(`execCommand Error: ${f}`)}s==null||s.removeAllRanges(),window.document.body.removeChild(o)};let ue;function Xt(e){if(!e)return"";ue||(ue=document.createElement("div"),ue.setAttribute("aria-hidden","true"),document.body.appendChild(ue));const t=We({render(){return u("div",null,[e])}});t.mount(ue);const o=ue.innerText;return t.unmount(),o}var Yt=Object.defineProperty,Zt=Object.defineProperties,eo=Object.getOwnPropertyDescriptors,Le=Object.getOwnPropertySymbols,to=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable,je=(e,t,o)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,no=(e,t)=>{for(var o in t||(t={}))to.call(t,o)&&je(e,o,t[o]);if(Le)for(var o of Le(t))oo.call(t,o)&&je(e,o,t[o]);return e},ao=(e,t)=>Zt(e,eo(t));function Ge(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vt(e)}function lo(e){const{bold:t,mark:o,underline:s,delete:c,code:f}=e,l=[];return t&&l.push("b"),s&&l.push("u"),c&&l.push("del"),f&&l.push("code"),o&&l.push("mark"),l}function De(e,t){const{mark:o}=e,s=lo(e),c=Z(o)&&o.color?{backgroundColor:o.color}:{};return s.reduce((f,l)=>u(l,l==="mark"?{style:c}:{},Ge(f)?f:{default:()=>[f]}),t)}function so(e){const t=!!e.showTooltip,o=Z(e.showTooltip)&&e.showTooltip.type==="popover"?yt:qe,s=Z(e.showTooltip)&&e.showTooltip.props||{};return ao(no({rows:1,suffix:"",ellipsisStr:"...",expandable:!1,css:!1},Fe(e,["showTooltip"])),{showTooltip:t,TooltipComponent:o,tooltipProps:s})}var ro=ae({name:"TypographyBase",inheritAttrs:!1,props:{component:{type:String,required:!0},type:{type:String},bold:{type:Boolean},mark:{type:[Boolean,Object],default:!1},underline:{type:Boolean},delete:{type:Boolean},code:{type:Boolean},disabled:{type:Boolean},editable:{type:Boolean},editing:{type:Boolean,default:void 0},defaultEditing:{type:Boolean},editText:{type:String},copyable:{type:Boolean},copyText:{type:String},copyDelay:{type:Number,default:3e3},ellipsis:{type:[Boolean,Object],default:!1},editTooltipProps:{type:Object},copyTooltipProps:{type:Object}},emits:{editStart:()=>!0,change:e=>!0,"update:editText":e=>!0,editEnd:()=>!0,"update:editing":e=>!0,copy:e=>!0,ellipsis:e=>!0,expand:e=>!0},setup(e,{slots:t,emit:o,attrs:s}){const{editing:c,defaultEditing:f,ellipsis:l,copyable:r,editable:i,copyText:a,editText:m,copyDelay:M,component:K}=Ie(e),p=ve("typography"),S=k(()=>[p,{[`${p}-${e.type}`]:e.type,[`${p}-disabled`]:e.disabled}]),y=C(),_=C(""),[O,z]=ct(f.value,ft({value:c})),w=k(()=>i.value&&O.value);function A(){o("update:editing",!0),o("editStart"),z(!0)}function j(d){o("update:editText",d),o("change",d)}function oe(){O.value&&(o("update:editing",!1),o("editEnd"),z(!1))}const B=C(!1);let N=null;function le(){var d;const H=(d=a.value)!=null?d:_.value;Qt(H||""),B.value=!0,o("copy",H),N=setTimeout(()=>{B.value=!1},M.value)}Oe(()=>{N&&clearTimeout(N),N=null});const D=C(!1),V=C(!1),U=C(""),$=k(()=>so(Z(l.value)&&l.value||{}));let G=null;function ne(){const d=!V.value;V.value=d,o("expand",d)}function R(d=!1){return $.value.css?u(He,{editable:i.value,copyable:r.value,expandable:$.value.expandable,isCopied:B.value,isEllipsis:re.value,expanded:V.value,forceRenderExpand:d||V.value,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:A,onCopy:le,onExpand:ne},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]}):u(He,{editable:i.value,copyable:r.value,expandable:$.value.expandable,isCopied:B.value,isEllipsis:D.value,expanded:V.value,forceRenderExpand:d,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:A,onCopy:le,onExpand:ne},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]})}function se(){if(!y.value)return;const{ellipsis:d,text:H}=Jt(y.value,$.value,R(!!$.value.expandable),_.value);D.value!==d&&(D.value=d,$.value.css||o("ellipsis",d)),U.value!==H&&(U.value=H||"")}function E(){l.value&&!V.value&&(Ne(G),G=ht(()=>{se()}))}Oe(()=>{Ne(G)}),fe(()=>$.value.rows,()=>{E()}),fe(l,d=>{d?E():D.value=!1});let J=[];const ye=()=>{if(l.value||r.value||i.value){const d=Xt(J);d!==_.value&&(_.value=d,E())}};Te(ye),Ue(ye);const de=C(),re=C(!1),he=()=>{if(y.value&&de.value){const d=de.value.offsetHeight>y.value.offsetHeight;d!==re.value&&(re.value=d,o("ellipsis",d))}},me=k(()=>V.value?{}:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":$.value.rows,"-webkit-box-orient":"vertical"});return()=>{var d,H;if(J=((d=t.default)==null?void 0:d.call(t))||[],w.value){const g=(H=m.value)!=null?H:_.value;return u(qt,{text:g,onChange:q=>{q!==g&&j(q)},onEnd:oe},null)}const{suffix:pe,ellipsisStr:ce,showTooltip:ie,tooltipProps:ge,TooltipComponent:be}=$.value,Y=D.value&&!V.value,n=Y&&!ie?{title:_.value}:{},v=K.value;if($.value.css){const g=De(e,J),q=u(v,te({class:S.value,ref:y,style:me.value},n,s),{default:()=>[u("span",{ref:de},[g])]});return re.value?u(be,te(ge,{onResize:()=>he()}),{default:()=>[q],content:()=>_.value}):u(Be,{onResize:()=>{he()}},Ge(q)?q:{default:()=>[q]})}const b=De(e,Y?U.value:J);return u(Be,{onResize:()=>E()},{default:()=>[u(v,te({class:S.value,ref:y},n,s),{default:()=>[Y&&ie?u(be,ge,{default:()=>[u("span",null,[b])],content:()=>_.value}):b,Y?ce:null,pe,R()]})]})}}}),io=ae({name:"TypographyParagraph",inheritAttrs:!1,props:{blockquote:{type:Boolean},spacing:{type:String,default:"default"}},setup(e){const{blockquote:t,spacing:o}=Ie(e),s=ve("typography"),c=k(()=>t!=null&&t.value?"blockquote":"div"),f=k(()=>[{[`${s}-spacing-close`]:(o==null?void 0:o.value)==="close"}]);return{component:c,classNames:f}},render(){const{component:e,classNames:t}=this;return u(ro,te({class:t},this.$attrs,{component:e}),this.$slots)}});const uo={key:0,class:"dark:text-white w-[4px] h-[20px] block animate-blink"},po={key:0},co=["innerHTML"],fo=["textContent"],vo=["textContent"],yo=ae({__name:"MessageContent",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean},asRawText:{type:Boolean}},setup(e){const t=e,o=C(),s=new Pt({linkify:!0,highlight(i,a){if(!!(a&&Ce.getLanguage(a))){const M=a!=null?a:"";return r(Ce.highlight(i,{language:M}).value,M)}return r(Ce.highlightAuto(i).value,"")}});s.use(zt,{attrs:{target:"_blank",rel:"noopener"}}),s.use(Ot,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const c=k(()=>["message-content","min-w-[20px]","rounded-md",t.inversion?"text-[#f1f1f1]":"bg-[#e5e6eb]",t.inversion?"text-[]":"dark:bg-[#1e1e20]",t.inversion?"message-request":"message-reply",{"text-red-500":t.error}]),f=i=>i.replace(/\n+$/g,""),l=k(()=>{var a;const i=f((a=t.text)!=null?a:"");return!t.asRawText&&!t.inversion?s.render(i):i});function r(i,a){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${a}</span><span class="code-block-header__copy">复制代码</span></div><code class="hljs code-block-body ${a}">${i}</code></pre>`}return Ue(()=>{o.value&&Ce.highlightBlock(o.value)}),(i,a)=>(h(),T("div",{class:L(P(c))},[e.loading?(h(),T("span",uo)):(h(),T("div",{key:1,ref_key:"textRef",ref:o,class:"leading-relaxed break-words"},[e.inversion?(h(),T("div",{key:1,class:"whitespace-pre-wrap",textContent:Q(P(l))},null,8,vo)):(h(),T("div",po,[e.asRawText?(h(),T("div",{key:1,class:"whitespace-pre-wrap",textContent:Q(P(l))},null,8,fo)):(h(),T("div",{key:0,class:"markdown-body",innerHTML:P(l)},null,8,co))]))],512))],2))}});const ho=mt(yo,[["__scopeId","data-v-a2d5d6d9"]]);const mo="/assets/openai-white-1b79b841.svg",go=e=>/^[\s\n\r]*$/.test(e),bo={key:0,class:"flex-1"},Co={class:"chat-wrapper"},wo=["src"],xo={class:"chat-footer"},_o={class:"flex items-center gap-x-2 w-32"},ko={class:"flex-1"},$o=ae({__name:"ChatView",setup(e){const t=gt(),o=bt(),s=k(()=>t.session),{isMobileScreen:c}=Ct(),f={user:Bt,assistant:mo},l=C(),r=C("新的聊天");wt(()=>{var p;r.value=((p=t.session)==null?void 0:p.topic)||"新的聊天"});const i=C(""),a=()=>{if(go(i.value)){Ae.clear(),Ae.error("请输入消息内容");return}t.sendMessageAction(i.value),i.value=""};Te(()=>{Re(()=>{var p,S,y,_;(_=l.value)==null||_.scrollTop(((y=(S=(p=l.value)==null?void 0:p.containerRef)==null?void 0:S.scrollHeight)!=null?y:0)-200)})});const m=p=>{o.changeSubmitKeyAction(p)},M=()=>{t.handleChangeSessionTopicAction(r.value)},K=p=>{o.submitKey===Se.Enter&&(p.shiftKey&&p.code==="Enter"?(p.preventDefault(),i.value+=`
`):!p.shiftKey&&p.code==="Enter"&&(p.preventDefault(),a())),o.submitKey===Se.ShiftEnter&&(!p.shiftKey&&p.code==="Enter"?(p.preventDefault(),i.value+=`
`):p.shiftKey&&p.code==="Enter"&&(p.preventDefault(),a()))};return(p,S)=>{const y=io,_=xt,O=_t,z=kt,w=Tt,A=St,j=Rt,oe=It,B=ho,N=Et,le=Dt,D=F("icon-send"),V=F("icon-down"),U=F("icon-check"),$=Vt,G=Nt,ne=$t;return h(),T(_e,null,[u(w,{class:"h-14 px-4 flex items-center bg-white dark:bg-dark"},{default:I(()=>[W("div",{class:L(["flex flex-col editable-title__wrapper",{"is-mobile":P(c)}])},[u(y,{class:"m-0",editable:"",editText:P(r),"onUpdate:editText":S[0]||(S[0]=R=>Ve(r)?r.value=R:null),onEditEnd:M},{default:I(()=>[ke(Q(P(r)),1)]),_:1},8,["editText"])],2),P(c)?X("",!0):(h(),T("i",bo)),P(c)?X("",!0):(h(),ee(z,{key:1},{default:I(()=>[u(_,{class:"w-44"}),u(O,{class:"w-60"})]),_:1}))]),_:1}),u(A,{class:"m-0"}),u(ne,{class:"flex flex-col flex-1 overflow-hidden"},{default:I(()=>[W("main",Co,[u(N,{ref_key:"scrollbarRef",ref:l,"outer-style":"flex: 1; overflow: hidden;",class:"overflow-y-auto h-full p-4 grid grid-cols-1 gap-y-2"},{default:I(()=>{var R,se;return[(h(!0),T(_e,null,Me((se=(R=P(s))==null?void 0:R.messages)!=null?se:[],E=>(h(),T("section",{key:E.id,class:L(["message-item",E.role==="assistant"?"is-reply":"is-request"])},[u(oe,{loading:E.streaming&&E.role==="assistant"},{default:I(()=>[u(j,{size:32,class:L(E.role==="assistant"?"bg-primary p-2":"bg-success")},{default:I(()=>{var J;return[W("img",{src:(J=f[E.role])!=null?J:""},null,8,wo)]}),_:2},1032,["class"])]),_:2},1032,["loading"]),W("section",{class:L(["flex flex-1 overflow-hidden px-4 py-3 text-sm rounded-lg max-w-max",{"justify-end bg-primary text-white":E.role==="user"},{"bg-white dark:bg-dark":E.role==="assistant"}])},[(h(),ee(B,{key:E.content,text:E.content,inversion:E.role!=="assistant"},null,8,["text","inversion"]))],2)],2))),128))]}),_:1},512),u(A,{class:"m-0"}),W("footer",xo,[u(le,{disabled:P(t).fetching,modelValue:P(i),"onUpdate:modelValue":S[1]||(S[1]=R=>Ve(i)?i.value=R:null),onKeydown:Ke(xe(K,["prevent"]),["enter"]),class:"bg-white dark:bg-dark-900 border-none","auto-size":{minRows:3,maxRows:5},placeholder:"请输入您的信息..."},null,8,["disabled","modelValue","onKeydown"]),u(G,{disabled:P(t).fetching,onClick:a,onSelect:m,type:"primary"},{icon:I(()=>[u(V)]),content:I(()=>[(h(!0),T(_e,null,Me(Object.values(P(Se)),R=>(h(),ee($,{key:R,value:R},{default:I(()=>[W("div",_o,[W("span",ko,Q(R),1),R===P(o).submitKey?(h(),ee(U,{key:0,class:"text-primary"})):X("",!0)])]),_:2},1032,["value"]))),128))]),default:I(()=>[u(D,{class:"mr-2"}),ke(" 发送 ")]),_:1},8,["disabled"])])])]),_:1})],64)}}});export{$o as default};
