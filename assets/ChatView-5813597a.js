import{g as ie,R as Re,I as Ge,h as Je,t as ze,i as ge,u as Ye,r as g,j as E,k as Qe,l as me,m as Xe,n as Ze,q as te,s as Ce,v as Ne,x as et,y as De,z as Me,A as tt,C as ke,D as U,o as h,E as S,F as q,G as ot,H as ne,J as K,b as c,w as R,a as ee,K as ae,L as we,M as nt,N as at,O as lt,P as st,T as Oe,Q as rt,U as it,V as ut,W as ct,c as re,X as Ee,d as Te,Y as dt,Z as Ie,$ as We,a0 as pt,a1 as ft,a2 as Pe,a3 as Ve,a4 as Le,a5 as vt,a6 as yt,a7 as ht,a8 as z,_ as mt,a9 as oe,aa as gt,ab as Ct,ac as bt,ad as xt,ae as Ae,af as _t,ag as wt,ah as kt,ai as Tt,aj as Et,ak as St,B as $t,S as Bt,al as Rt,am as It,an as Se,ao as Pt,ap as zt}from"./index-01bd221d.js";import{M as Nt,H as _e,m as Ot,a as Lt}from"./index-b7903ef7.js";const Mt=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Vt=e=>{const t={};return Mt.forEach(o=>{t[o]=e.getPropertyValue(o)}),t},At=ie({name:"Textarea",components:{ResizeObserver:Re,IconHover:Ge,IconClose:Je},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:o}){const{disabled:r,error:f,modelValue:p}=ze(e),s=ge("textarea"),{mergedDisabled:l,mergedError:v,eventHandlers:a}=Ye({disabled:r,error:f}),m=g(),P=g(),D=g(),A=g(),H=g(e.defaultValue),C=E(()=>{var n;return(n=p.value)!=null?n:H.value}),[I,N]=Qe(m);me(p,n=>{(Xe(n)||Ze(n))&&(H.value="")});const i=E(()=>te(e.maxLength)&&!!e.maxLength.errorOnly),u=E(()=>te(e.maxLength)?e.maxLength.length:e.maxLength),_=n=>{var y;return et(e.wordLength)?e.wordLength(n):(y=n.length)!=null?y:0},w=E(()=>_(C.value)),O=E(()=>v.value||!!(u.value&&i.value&&w.value>u.value)),$=g(!1),L=g(!1),le=E(()=>e.allowClear&&!l.value&&C.value),W=g(!1),M=g(""),Y=()=>{I(),ke(()=>{m.value&&C.value!==m.value.value&&(m.value.value=C.value,N())})},B=(n,y=!0)=>{var x,b;u.value&&!i.value&&_(n)>u.value&&(n=(b=(x=e.wordSlice)==null?void 0:x.call(e,n,u.value))!=null?b:n.slice(0,u.value)),H.value=n,y&&t("update:modelValue",n),Y()};let G=C.value;const se=(n,y)=>{var x,b;n!==G&&(G=n,t("change",n,y),(b=(x=a.value)==null?void 0:x.onChange)==null||b.call(x,y))},ue=n=>{var y,x;L.value=!0,G=C.value,t("focus",n),(x=(y=a.value)==null?void 0:y.onFocus)==null||x.call(y,n)},ve=n=>{var y,x;L.value=!1,t("blur",n),(x=(y=a.value)==null?void 0:y.onBlur)==null||x.call(y,n),se(C.value,n)},Q=n=>{var y,x;const{value:b}=n.target;if(n.type==="compositionend"){if(W.value=!1,M.value="",u.value&&!i.value&&C.value.length>=u.value&&_(b)>u.value){Y();return}t("input",b,n),B(b),(x=(y=a.value)==null?void 0:y.onInput)==null||x.call(y,n)}else W.value=!0},X=n=>{var y,x;const{value:b}=n.target;if(W.value)M.value=b;else{if(u.value&&!i.value&&C.value.length>=u.value&&_(b)>u.value&&n.inputType==="insertText"){Y();return}t("input",b,n),B(b),(x=(y=a.value)==null?void 0:y.onInput)==null||x.call(y,n)}},ce=n=>{B(""),se("",n),t("clear",n)};me(p,n=>{n!==C.value&&B(n!=null?n:"",!1)});const V=n=>De(o,Me),j=n=>tt(o,Me),k=E(()=>[`${s}-wrapper`,{[`${s}-focus`]:L.value,[`${s}-disabled`]:l.value,[`${s}-error`]:O.value,[`${s}-scroll`]:$.value}]);let de;const d=g(0),F=g(0),ye=E(()=>!te(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*d.value+F.value),he=E(()=>!te(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*d.value+F.value),pe=()=>{const n=Vt(de);d.value=Number.parseInt(n["line-height"]||0,10),F.value=Number.parseInt(n["border-width"]||0,10)*2+Number.parseInt(n["padding-top"]||0,10)+Number.parseInt(n["padding-bottom"]||0,10),A.value=n,ke(()=>{var y;const x=(y=D.value)==null?void 0:y.offsetHeight;let b=x!=null?x:0,J="hidden";ye.value&&b<ye.value&&(b=ye.value),he.value&&b>he.value&&(b=he.value,J="auto"),P.value={height:`${b}px`,resize:"none",overflow:J}})};Ce(()=>{m.value&&(de=window.getComputedStyle(m.value),e.autoSize&&pe()),Z()});const be=()=>{e.autoSize&&D.value&&pe(),Z()},xe=n=>{m.value&&n.target!==m.value&&(n.preventDefault(),m.value.focus())},Z=()=>{m.value&&(m.value.scrollHeight>m.value.offsetHeight?$.value||($.value=!0):$.value&&($.value=!1))};return me(C,()=>{e.autoSize&&D.value&&pe(),Z()}),{prefixCls:s,wrapperCls:k,textareaRef:m,textareaStyle:P,mirrorRef:D,mirrorStyle:A,computedValue:C,showClearBtn:le,valueLength:w,computedMaxLength:u,mergedDisabled:l,getWrapperAttrs:V,getTextareaAttrs:j,handleInput:X,handleFocus:ue,handleBlur:ve,handleComposition:Q,handleClear:ce,handleResize:be,handleMousedown:xe}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),Ht=["disabled","value","placeholder"];function jt(e,t,o,r,f,p){const s=U("resize-observer"),l=U("icon-close"),v=U("icon-hover");return h(),S("div",ae(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...a)=>e.handleMousedown&&e.handleMousedown(...a))}),[e.autoSize?(h(),S("div",{key:0,ref:"mirrorRef",class:q(`${e.prefixCls}-mirror`),style:ot(e.mirrorStyle)},ne(`${e.computedValue}
`),7)):K("v-if",!0),c(s,{onResize:e.handleResize},{default:R(()=>[ee("textarea",ae({ref:"textareaRef"},e.getTextareaAttrs(e.$attrs),{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...a)=>e.handleInput&&e.handleInput(...a)),onFocus:t[1]||(t[1]=(...a)=>e.handleFocus&&e.handleFocus(...a)),onBlur:t[2]||(t[2]=(...a)=>e.handleBlur&&e.handleBlur(...a)),onCompositionstart:t[3]||(t[3]=(...a)=>e.handleComposition&&e.handleComposition(...a)),onCompositionupdate:t[4]||(t[4]=(...a)=>e.handleComposition&&e.handleComposition(...a)),onCompositionend:t[5]||(t[5]=(...a)=>e.handleComposition&&e.handleComposition(...a))}),null,16,Ht)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(h(),S("div",{key:1,class:q(`${e.prefixCls}-word-limit`)},ne(e.valueLength)+"/"+ne(e.computedMaxLength),3)):K("v-if",!0),e.showClearBtn?(h(),S("div",{key:2,class:q(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...a)=>e.handleClear&&e.handleClear(...a))},[c(v,null,{default:R(()=>[c(l)]),_:1})],2)):K("v-if",!0)],16)}var $e=Ne(At,[["render",jt]]);const Ft=Object.assign($e,{install:(e,t)=>{nt(e,t);const o=at(t);e.component(o+$e.name,$e)}}),qt=ie({name:"TypographyEditContent",components:{Input:lt},props:{text:{type:String,required:!0}},emits:["change","end","update:text"],setup(e,{emit:t}){const r=[`${ge("typography")}-edit-content`],f=g();function p(l){t("update:text",l),t("change",l)}function s(){t("end")}return Ce(()=>{if(!f.value||!f.value.$el)return;const l=f.value.$el.querySelector("input");if(!l)return;l.focus&&l.focus();const{length:v}=l.value;l.setSelectionRange(v,v)}),{classNames:r,inputRef:f,onBlur:s,onChange:p,onEnd:s}}});function Dt(e,t,o,r,f,p){const s=U("Input");return h(),S("div",{class:q(e.classNames)},[c(s,{ref:"inputRef","auto-size":"","model-value":e.text,onBlur:e.onBlur,onInput:e.onChange,onKeydown:st(e.onEnd,["enter"])},null,8,["model-value","onBlur","onInput","onKeydown"])],2)}var Wt=Ne(qt,[["render",Dt]]);const Kt=ie({name:"TypographyOperations",components:{Tooltip:Oe,IconCheckCircleFill:rt,IconCopy:it,IconEdit:ut},props:{editable:Boolean,copyable:Boolean,expandable:Boolean,isCopied:Boolean,isEllipsis:Boolean,expanded:Boolean,forceRenderExpand:Boolean,editTooltipProps:Object,copyTooltipProps:Object},emits:{edit:()=>!0,copy:()=>!0,expand:()=>!0},setup(e,{emit:t}){const o=ge("typography"),r=E(()=>e.forceRenderExpand||e.expandable&&e.isEllipsis),{t:f}=ct();return{prefixCls:o,showExpand:r,t:f,onEditClick(){t("edit")},onCopyClick(){t("copy")},onExpandClick(){t("expand")}}}});function Ut(e,t,o,r,f,p){const s=U("IconEdit"),l=U("Tooltip"),v=U("IconCheckCircleFill"),a=U("IconCopy");return h(),S(Ie,null,[e.editable?(h(),re(l,ae({key:0,content:e.t("typography.edit")},e.editTooltipProps),{default:R(()=>[ee("span",{class:q(`${e.prefixCls}-operation-edit`),onClick:t[0]||(t[0]=Ee((...m)=>e.onEditClick&&e.onEditClick(...m),["stop"]))},[c(s)],2)]),_:1},16,["content"])):K("v-if",!0),e.copyable?(h(),re(l,dt(ae({key:1},e.copyTooltipProps)),{content:R(()=>[we(e.$slots,"copy-tooltip",{copied:e.isCopied},()=>[Te(ne(e.isCopied?e.t("typography.copied"):e.t("typography.copy")),1)])]),default:R(()=>[ee("span",{class:q({[`${e.prefixCls}-operation-copied`]:e.isCopied,[`${e.prefixCls}-operation-copy`]:!e.isCopied}),onClick:t[1]||(t[1]=Ee((...m)=>e.onCopyClick&&e.onCopyClick(...m),["stop"]))},[we(e.$slots,"copy-icon",{copied:e.isCopied},()=>[e.isCopied?(h(),re(v,{key:0})):(h(),re(a,{key:1}))])],2)]),_:3},16)):K("v-if",!0),e.showExpand?(h(),S("a",{key:2,class:q(`${e.prefixCls}-operation-expand`),onClick:t[2]||(t[2]=Ee((...m)=>e.onExpandClick&&e.onExpandClick(...m),["stop"]))},[we(e.$slots,"expand-node",{expanded:e.expanded},()=>[Te(ne(e.expanded?e.t("typography.collapse"):e.t("typography.expand")),1)])],2)):K("v-if",!0)],64)}var He=Ne(Kt,[["render",Ut]]);let T;function Gt(e){return Array.prototype.slice.apply(e).map(o=>`${o}: ${e.getPropertyValue(o)};`).join("")}function Be(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var Jt=(e,t,o,r)=>{T||(T=document.createElement("div"),document.body.appendChild(T));const{rows:f,suffix:p,ellipsisStr:s}=t,l=window.getComputedStyle(e),v=Gt(l),a=Be(l.lineHeight),m=Math.round(a*f+Be(l.paddingTop)+Be(l.paddingBottom));T.setAttribute("style",v),T.setAttribute("aria-hidden","true"),T.style.height="auto",T.style.minHeight="auto",T.style.maxHeight="auto",T.style.position="fixed",T.style.left="0",T.style.top="-99999999px",T.style.zIndex="-200",T.style.whiteSpace="normal";const P=We({render(){return c("span",null,[o])}});P.mount(T);const D=Array.prototype.slice.apply(T.childNodes[0].cloneNode(!0).childNodes);P.unmount(),T.innerHTML="";const A=document.createTextNode(`${s}${p}`);T.appendChild(A),D.forEach(N=>{T.appendChild(N)});const H=document.createTextNode(r);T.insertBefore(H,A);function C(){return T.offsetHeight<=m}if(C())return{ellipsis:!1,text:r};function I(N,i=0,u=r.length,_=0){const w=Math.floor((i+u)/2),O=r.slice(0,w);if(N.textContent=O,i>=u-1)for(let $=u;$>=i;$-=1){const L=r.slice(0,$);if(N.textContent=L,C()||!L)return}C()?I(N,w,u,w):I(N,i,w,_)}return I(H),{text:H.textContent,ellipsis:!0}};const Yt=async e=>{var t;if((t=navigator.clipboard)!=null&&t.writeText)try{await navigator.clipboard.writeText(e);return}catch(p){console.error(p!=null?p:new DOMException("The request is not allowed","NotAllowedError"))}const o=document.createElement("span");o.textContent=e,o.style.whiteSpace="pre",document.body.appendChild(o);const r=window.getSelection(),f=window.document.createRange();r==null||r.removeAllRanges(),f.selectNode(o),r==null||r.addRange(f);try{window.document.execCommand("copy")}catch(p){console.error(`execCommand Error: ${p}`)}r==null||r.removeAllRanges(),window.document.body.removeChild(o)};let fe;function Qt(e){if(!e)return"";fe||(fe=document.createElement("div"),fe.setAttribute("aria-hidden","true"),document.body.appendChild(fe));const t=We({render(){return c("div",null,[e])}});t.mount(fe);const o=fe.innerText;return t.unmount(),o}var Xt=Object.defineProperty,Zt=Object.defineProperties,eo=Object.getOwnPropertyDescriptors,je=Object.getOwnPropertySymbols,to=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable,Fe=(e,t,o)=>t in e?Xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,no=(e,t)=>{for(var o in t||(t={}))to.call(t,o)&&Fe(e,o,t[o]);if(je)for(var o of je(t))oo.call(t,o)&&Fe(e,o,t[o]);return e},ao=(e,t)=>Zt(e,eo(t));function Ke(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vt(e)}function lo(e){const{bold:t,mark:o,underline:r,delete:f,code:p}=e,s=[];return t&&s.push("b"),r&&s.push("u"),f&&s.push("del"),p&&s.push("code"),o&&s.push("mark"),s}function qe(e,t){const{mark:o}=e,r=lo(e),f=te(o)&&o.color?{backgroundColor:o.color}:{};return r.reduce((p,s)=>c(s,s==="mark"?{style:f}:{},Ke(p)?p:{default:()=>[p]}),t)}function so(e){const t=!!e.showTooltip,o=te(e.showTooltip)&&e.showTooltip.type==="popover"?yt:Oe,r=te(e.showTooltip)&&e.showTooltip.props||{};return ao(no({rows:1,suffix:"",ellipsisStr:"...",expandable:!1,css:!1},De(e,["showTooltip"])),{showTooltip:t,TooltipComponent:o,tooltipProps:r})}var ro=ie({name:"TypographyBase",inheritAttrs:!1,props:{component:{type:String,required:!0},type:{type:String},bold:{type:Boolean},mark:{type:[Boolean,Object],default:!1},underline:{type:Boolean},delete:{type:Boolean},code:{type:Boolean},disabled:{type:Boolean},editable:{type:Boolean},editing:{type:Boolean,default:void 0},defaultEditing:{type:Boolean},editText:{type:String},copyable:{type:Boolean},copyText:{type:String},copyDelay:{type:Number,default:3e3},ellipsis:{type:[Boolean,Object],default:!1},editTooltipProps:{type:Object},copyTooltipProps:{type:Object}},emits:{editStart:()=>!0,change:e=>!0,"update:editText":e=>!0,editEnd:()=>!0,"update:editing":e=>!0,copy:e=>!0,ellipsis:e=>!0,expand:e=>!0},setup(e,{slots:t,emit:o,attrs:r}){const{editing:f,defaultEditing:p,ellipsis:s,copyable:l,editable:v,copyText:a,editText:m,copyDelay:P,component:D}=ze(e),A=ge("typography"),H=E(()=>[A,{[`${A}-${e.type}`]:e.type,[`${A}-disabled`]:e.disabled}]),C=g(),I=g(""),[N,i]=pt(p.value,ft({value:f})),u=E(()=>v.value&&N.value);function _(){o("update:editing",!0),o("editStart"),i(!0)}function w(d){o("update:editText",d),o("change",d)}function O(){N.value&&(o("update:editing",!1),o("editEnd"),i(!1))}const $=g(!1);let L=null;function le(){var d;const F=(d=a.value)!=null?d:I.value;Yt(F||""),$.value=!0,o("copy",F),L=setTimeout(()=>{$.value=!1},P.value)}Pe(()=>{L&&clearTimeout(L),L=null});const W=g(!1),M=g(!1),Y=g(""),B=E(()=>so(te(s.value)&&s.value||{}));let G=null;function se(){const d=!M.value;M.value=d,o("expand",d)}function ue(d=!1){return B.value.css?c(He,{editable:v.value,copyable:l.value,expandable:B.value.expandable,isCopied:$.value,isEllipsis:j.value,expanded:M.value,forceRenderExpand:d||M.value,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:_,onCopy:le,onExpand:se},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]}):c(He,{editable:v.value,copyable:l.value,expandable:B.value.expandable,isCopied:$.value,isEllipsis:W.value,expanded:M.value,forceRenderExpand:d,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:_,onCopy:le,onExpand:se},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]})}function ve(){if(!C.value)return;const{ellipsis:d,text:F}=Jt(C.value,B.value,ue(!!B.value.expandable),I.value);W.value!==d&&(W.value=d,B.value.css||o("ellipsis",d)),Y.value!==F&&(Y.value=F||"")}function Q(){s.value&&!M.value&&(Ve(G),G=ht(()=>{ve()}))}Pe(()=>{Ve(G)}),me(()=>B.value.rows,()=>{Q()}),me(s,d=>{d?Q():W.value=!1});let X=[];const ce=()=>{if(s.value||l.value||v.value){const d=Qt(X);d!==I.value&&(I.value=d,Q())}};Ce(ce),Le(ce);const V=g(),j=g(!1),k=()=>{if(C.value&&V.value){const d=V.value.offsetHeight>C.value.offsetHeight;d!==j.value&&(j.value=d,o("ellipsis",d))}},de=E(()=>M.value?{}:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":B.value.rows,"-webkit-box-orient":"vertical"});return()=>{var d,F;if(X=((d=t.default)==null?void 0:d.call(t))||[],u.value){const b=(F=m.value)!=null?F:I.value;return c(Wt,{text:b,onChange:J=>{J!==b&&w(J)},onEnd:O},null)}const{suffix:ye,ellipsisStr:he,showTooltip:pe,tooltipProps:be,TooltipComponent:xe}=B.value,Z=W.value&&!M.value,n=Z&&!pe?{title:I.value}:{},y=D.value;if(B.value.css){const b=qe(e,X),J=c(y,ae({class:H.value,ref:C,style:de.value},n,r),{default:()=>[c("span",{ref:V},[b])]});return j.value?c(xe,ae(be,{onResize:()=>k()}),{default:()=>[J],content:()=>I.value}):c(Re,{onResize:()=>{k()}},Ke(J)?J:{default:()=>[J]})}const x=qe(e,Z?Y.value:X);return c(Re,{onResize:()=>Q()},{default:()=>[c(y,ae({class:H.value,ref:C},n,r),{default:()=>[Z&&pe?c(xe,be,{default:()=>[c("span",null,[x])],content:()=>I.value}):x,Z?he:null,ye,ue()]})]})}}}),io=ie({name:"TypographyParagraph",inheritAttrs:!1,props:{blockquote:{type:Boolean},spacing:{type:String,default:"default"}},setup(e){const{blockquote:t,spacing:o}=ze(e),r=ge("typography"),f=E(()=>t!=null&&t.value?"blockquote":"div"),p=E(()=>[{[`${r}-spacing-close`]:(o==null?void 0:o.value)==="close"}]);return{component:f,classNames:p}},render(){const{component:e,classNames:t}=this;return c(ro,ae({class:t},this.$attrs,{component:e}),this.$slots)}});const uo={key:0,class:"dark:text-white w-[4px] h-[20px] block animate-blink"},co={key:0},po=["innerHTML"],fo=["textContent"],vo=["textContent"],yo=ie({__name:"MessageContent",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean},asRawText:{type:Boolean}},setup(e){const t=e,o=g(),r=new Nt({linkify:!0,highlight(v,a){if(!!(a&&_e.getLanguage(a))){const P=a!=null?a:"";return l(_e.highlight(v,{language:P}).value,P)}return l(_e.highlightAuto(v).value,"")}});r.use(Ot,{attrs:{target:"_blank",rel:"noopener"}}),r.use(Lt,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const f=E(()=>["message-content","min-w-[20px]","rounded-md",t.inversion?"text-[#f1f1f1]":"bg-[#e5e6eb]",t.inversion?"text-[]":"dark:bg-[#1e1e20]",t.inversion?"message-request":"message-reply",{"text-red-500":t.error}]),p=v=>v.replace(/\n+$/g,""),s=E(()=>{var a;const v=p((a=t.text)!=null?a:"");return!t.asRawText&&!t.inversion?r.render(v):v});function l(v,a){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${a}</span><span class="code-block-header__copy">复制代码</span></div><code class="hljs code-block-body ${a}">${v}</code></pre>`}return Le(()=>{ke(()=>{o.value&&_e.highlightBlock(o.value)})}),(v,a)=>(h(),S("div",{class:q(z(f))},[e.loading?(h(),S("span",uo)):(h(),S("div",{key:1,ref_key:"textRef",ref:o,class:"leading-relaxed break-words"},[e.inversion?(h(),S("div",{key:1,class:"whitespace-pre-wrap",textContent:ne(z(s))},null,8,vo)):(h(),S("div",co,[e.asRawText?(h(),S("div",{key:1,class:"whitespace-pre-wrap",textContent:ne(z(s))},null,8,fo)):(h(),S("div",{key:0,class:"markdown-body",innerHTML:z(s)},null,8,po))]))],512))],2))}});const ho=mt(yo,[["__scopeId","data-v-cf02b953"]]);const mo="/assets/openai-white-1b79b841.svg";function Ue(e){const t={origin:!0,...e};let o;t.origin?o=document.createElement("textarea"):o=document.createElement("input"),o.setAttribute("readonly","readonly"),o.value=t.text,document.body.appendChild(o),o.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(o)}function go(){function e(){document.querySelectorAll(".code-block-wrapper").forEach(o=>{const r=o.querySelector(".code-block-header__copy"),f=o.querySelector(".code-block-body");r&&f&&r.addEventListener("click",()=>{var p,s,l;(p=navigator.clipboard)!=null&&p.writeText?(navigator.clipboard.writeText((s=f.textContent)!=null?s:""),oe.clear(),oe.success("复制成功")):(Ue({text:(l=f.textContent)!=null?l:"",origin:!0}),oe.clear(),oe.success("复制成功"))})})}Ce(()=>e()),Le(()=>e())}const Co=e=>/^[\s\n\r]*$/.test(e),bo={key:0,class:"flex-1"},xo={class:"chat-wrapper"},_o=["src"],wo={key:0,class:"text-info"},ko={key:0,class:"message-item__actions"},To={class:"chat-footer"},$o=ie({__name:"ChatView",setup(e){go();const t=gt(),o=Ct(),r=E(()=>t.session),{isMobileScreen:f}=bt(),p=g(!1),s={user:It,assistant:mo},l=g(),v=g("新的聊天");xt(()=>{var i;v.value=((i=t.session)==null?void 0:i.topic)||"新的聊天"});const a=g(""),m=i=>{p.value=!1,t.messageRetryAction(i,()=>{var u,_,w,O;p.value||(O=l.value)==null||O.scrollTop(((w=(_=(u=l.value)==null?void 0:u.containerRef)==null?void 0:_.scrollHeight)!=null?w:0)-200)},u=>{P.value=u})},P=g(),D=()=>{if(Co(a.value)){oe.clear(),oe.error("请输入消息内容");return}p.value=!1,t.sendMessageAction(a.value,()=>{var i,u,_,w;p.value||(w=l.value)==null||w.scrollTop(((_=(u=(i=l.value)==null?void 0:i.containerRef)==null?void 0:u.scrollHeight)!=null?_:0)-200)},i=>{P.value=i}),a.value=""},A=i=>{i.deltaY<10&&(p.value=!0)};Ce(()=>{ke(()=>{var i,u,_,w,O,$;console.log((i=l.value)==null?void 0:i.$el),(O=l.value)==null||O.scrollTop(((w=(_=(u=l.value)==null?void 0:u.containerRef)==null?void 0:_.scrollHeight)!=null?w:0)-200),($=l.value)==null||$.$el.querySelector(".arco-scrollbar-container").addEventListener("wheel",A)})}),Pe(()=>{var i;(i=l.value)==null||i.$el.querySelector(".arco-scrollbar-container").removeEventListener("wheel",A)});const H=()=>{t.handleChangeSessionTopicAction(v.value)},C=i=>{f.value?i.key==="Enter"&&i.shiftKey&&(i.preventDefault(),D()):i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),D())},I=i=>{Ue({text:i}),oe.clear(),oe.success("复制成功")},N=E(()=>`请输入您的消息，${o.submitKey} 发送，${o.submitKey===Se.Enter?Se.ShiftEnter:Se.Enter} 换行`);return(i,u)=>{const _=io,w=wt,O=kt,$=Tt,L=Et,le=St,W=Pt,M=zt,Y=U("icon-copy"),B=$t,G=Oe,se=U("icon-sync"),ue=ho,ve=Bt,Q=U("icon-record-stop"),X=Ft,ce=Rt;return h(),S(Ie,null,[c(L,{class:"h-14 px-4 flex items-center bg-white dark:bg-dark"},{default:R(()=>[ee("div",{class:q(["flex flex-col editable-title__wrapper",{"is-mobile":z(f)}])},[c(_,{class:"m-0",editable:"",editText:z(v),"onUpdate:editText":u[0]||(u[0]=V=>Ae(v)?v.value=V:null),onEditEnd:H},{default:R(()=>[Te(ne(z(v)),1)]),_:1},8,["editText"])],2),z(f)?K("",!0):(h(),S("i",bo)),z(f)?K("",!0):(h(),re($,{key:1},{default:R(()=>[c(w,{class:"w-44"}),c(O,{class:"w-60"})]),_:1}))]),_:1}),c(le,{class:"m-0"}),c(ce,{class:"flex flex-col flex-1 overflow-hidden"},{default:R(()=>[ee("main",xo,[c(ve,{ref_key:"scrollbarRef",ref:l,"outer-style":"flex: 1; overflow: hidden; ",class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2 pb-20"},{default:R(()=>{var V,j;return[(h(!0),S(Ie,null,_t((j=(V=z(r))==null?void 0:V.messages)!=null?j:[],(k,de)=>(h(),S("section",{key:k.id,class:q(["message-item",[k.role==="assistant"?"is-reply":"is-request"]])},[c(M,{loading:k.streaming&&k.role==="assistant"},{default:R(()=>[c(W,{size:32,class:q(k.role==="assistant"?"bg-primary p-2":"bg-success")},{default:R(()=>{var d;return[ee("img",{src:(d=s[k.role])!=null?d:""},null,8,_o)]}),_:2},1032,["class"])]),_:2},1032,["loading"]),k.streaming&&k.role==="assistant"?(h(),S("small",wo," 正在输入... ")):K("",!0),ee("section",{class:q(["message-item__content",{"is-user":k.role==="user"},{"is-assistant":k.role==="assistant"}])},[k.role==="assistant"?(h(),S("div",ko,[c(G,{"content-class":"text-xs",content:"复制",position:"top"},{default:R(()=>[c(B,{onClick:d=>I(k.content),size:"mini",shape:"circle",type:"text"},{default:R(()=>[c(Y,{class:"text-base"})]),_:2},1032,["onClick"])]),_:2},1024),c(G,{"content-class":"text-xs",content:"重试",position:"top"},{default:R(()=>[c(B,{onClick:d=>m(de),size:"mini",shape:"circle",type:"text"},{default:R(()=>[c(se,{class:"text-base"})]),_:2},1032,["onClick"])]),_:2},1024)])):K("",!0),(h(),re(ue,{key:k.content,text:k.content,inversion:k.role!=="assistant"},null,8,["text","inversion"]))],2)],2))),128))]}),_:1},512),c(le,{class:"m-0"}),ee("footer",To,[z(t).fetching?(h(),re(B,{key:0,onClick:u[1]||(u[1]=V=>{var j;return(j=z(P))==null?void 0:j.abort()}),shape:"round",status:"danger",class:"stop-receiving"},{default:R(()=>[c(Q,{class:"text-lg mr-2"}),Te(" 停止 ")]),_:1})):K("",!0),c(X,{modelValue:z(a),"onUpdate:modelValue":u[2]||(u[2]=V=>Ae(a)?a.value=V:null),onKeypress:C,class:"bg-white dark:bg-dark-900 border-none","auto-size":{minRows:4,maxRows:6},placeholder:z(N)},null,8,["modelValue","placeholder"])])])]),_:1})],64)}}});export{$o as default};
