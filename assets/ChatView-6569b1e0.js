import{g as re,R as Ie,I as Qe,h as Xe,t as Pe,i as ge,u as Ye,r as b,j as B,k as Ze,l as he,m as et,n as tt,q as oe,s as be,v as ze,x as ot,y as qe,z as Me,A as nt,C as Se,D as N,o as y,E as w,F as L,G as at,H as X,J as q,b as i,w as x,a as K,K as ae,L as we,M as lt,N as st,O as rt,P as We,T as Oe,Q as it,U as ut,V as ct,W as dt,c as ne,X as ke,d as Ee,Y as pt,Z as Te,$ as Ue,a0 as ft,a1 as vt,a2 as Ve,a3 as Ae,a4 as Ne,a5 as yt,a6 as mt,a7 as ht,a8 as P,_ as gt,a9 as fe,aa as bt,ab as Ct,ac as _t,ad as xt,ae as He,af as Le,ag as wt,ah as kt,ai as Tt,aj as St,ak as Et,al as $t,B as Bt,S as Rt,am as It,an as $e,ao as Pt,ap as zt}from"./index-5be0068e.js";import{M as Ot,H as xe,m as Nt,a as Mt}from"./index-b7903ef7.js";import{D as Vt,a as At}from"./dropdown-button-4c8ae932.js";const Ht=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Lt=e=>{const t={};return Ht.forEach(o=>{t[o]=e.getPropertyValue(o)}),t},jt=re({name:"Textarea",components:{ResizeObserver:Ie,IconHover:Qe,IconClose:Xe},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:o}){const{disabled:r,error:p,modelValue:f}=Pe(e),l=ge("textarea"),{mergedDisabled:u,mergedError:d,eventHandlers:s}=Ye({disabled:r,error:p}),m=b(),M=b(),W=b(),j=b(),V=b(e.defaultValue),a=B(()=>{var n;return(n=f.value)!=null?n:V.value}),[h,E]=Ze(m);he(f,n=>{(et(n)||tt(n))&&(V.value="")});const k=B(()=>oe(e.maxLength)&&!!e.maxLength.errorOnly),_=B(()=>oe(e.maxLength)?e.maxLength.length:e.maxLength),D=n=>{var v;return ot(e.wordLength)?e.wordLength(n):(v=n.length)!=null?v:0},F=B(()=>D(a.value)),Y=B(()=>d.value||!!(_.value&&k.value&&F.value>_.value)),I=b(!1),z=b(!1),ie=B(()=>e.allowClear&&!u.value&&a.value),A=b(!1),O=b(""),J=()=>{h(),Se(()=>{m.value&&a.value!==m.value.value&&(m.value.value=a.value,E())})},R=(n,v=!0)=>{var C,g;_.value&&!k.value&&D(n)>_.value&&(n=(g=(C=e.wordSlice)==null?void 0:C.call(e,n,_.value))!=null?g:n.slice(0,_.value)),V.value=n,v&&t("update:modelValue",n),J()};let Q=a.value;const le=(n,v)=>{var C,g;n!==Q&&(Q=n,t("change",n,v),(g=(C=s.value)==null?void 0:C.onChange)==null||g.call(C,v))},ue=n=>{var v,C;z.value=!0,Q=a.value,t("focus",n),(C=(v=s.value)==null?void 0:v.onFocus)==null||C.call(v,n)},ve=n=>{var v,C;z.value=!1,t("blur",n),(C=(v=s.value)==null?void 0:v.onBlur)==null||C.call(v,n),le(a.value,n)},Z=n=>{var v,C;const{value:g}=n.target;if(n.type==="compositionend"){if(A.value=!1,O.value="",_.value&&!k.value&&a.value.length>=_.value&&D(g)>_.value){J();return}t("input",g,n),R(g),(C=(v=s.value)==null?void 0:v.onInput)==null||C.call(v,n)}else A.value=!0},ee=n=>{var v,C;const{value:g}=n.target;if(A.value)O.value=g;else{if(_.value&&!k.value&&a.value.length>=_.value&&D(g)>_.value&&n.inputType==="insertText"){J();return}t("input",g,n),R(g),(C=(v=s.value)==null?void 0:v.onInput)==null||C.call(v,n)}},ce=n=>{R(""),le("",n),t("clear",n)};he(f,n=>{n!==a.value&&R(n!=null?n:"",!1)});const se=n=>qe(o,Me),$=n=>nt(o,Me),U=B(()=>[`${l}-wrapper`,{[`${l}-focus`]:z.value,[`${l}-disabled`]:u.value,[`${l}-error`]:Y.value,[`${l}-scroll`]:I.value}]);let T;const c=b(0),H=b(0),ye=B(()=>!oe(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*c.value+H.value),me=B(()=>!oe(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*c.value+H.value),de=()=>{const n=Lt(T);c.value=Number.parseInt(n["line-height"]||0,10),H.value=Number.parseInt(n["border-width"]||0,10)*2+Number.parseInt(n["padding-top"]||0,10)+Number.parseInt(n["padding-bottom"]||0,10),j.value=n,Se(()=>{var v;const C=(v=W.value)==null?void 0:v.offsetHeight;let g=C!=null?C:0,G="hidden";ye.value&&g<ye.value&&(g=ye.value),me.value&&g>me.value&&(g=me.value,G="auto"),M.value={height:`${g}px`,resize:"none",overflow:G}})};be(()=>{m.value&&(T=window.getComputedStyle(m.value),e.autoSize&&de()),te()});const Ce=()=>{e.autoSize&&W.value&&de(),te()},_e=n=>{m.value&&n.target!==m.value&&(n.preventDefault(),m.value.focus())},te=()=>{m.value&&(m.value.scrollHeight>m.value.offsetHeight?I.value||(I.value=!0):I.value&&(I.value=!1))};return he(a,()=>{e.autoSize&&W.value&&de(),te()}),{prefixCls:l,wrapperCls:U,textareaRef:m,textareaStyle:M,mirrorRef:W,mirrorStyle:j,computedValue:a,showClearBtn:ie,valueLength:F,computedMaxLength:_,mergedDisabled:u,getWrapperAttrs:se,getTextareaAttrs:$,handleInput:ee,handleFocus:ue,handleBlur:ve,handleComposition:Z,handleClear:ce,handleResize:Ce,handleMousedown:_e}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),Dt=["disabled","value","placeholder"];function Ft(e,t,o,r,p,f){const l=N("resize-observer"),u=N("icon-close"),d=N("icon-hover");return y(),w("div",ae(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...s)=>e.handleMousedown&&e.handleMousedown(...s))}),[e.autoSize?(y(),w("div",{key:0,ref:"mirrorRef",class:L(`${e.prefixCls}-mirror`),style:at(e.mirrorStyle)},X(`${e.computedValue}
`),7)):q("v-if",!0),i(l,{onResize:e.handleResize},{default:x(()=>[K("textarea",ae({ref:"textareaRef"},e.getTextareaAttrs(e.$attrs),{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...s)=>e.handleInput&&e.handleInput(...s)),onFocus:t[1]||(t[1]=(...s)=>e.handleFocus&&e.handleFocus(...s)),onBlur:t[2]||(t[2]=(...s)=>e.handleBlur&&e.handleBlur(...s)),onCompositionstart:t[3]||(t[3]=(...s)=>e.handleComposition&&e.handleComposition(...s)),onCompositionupdate:t[4]||(t[4]=(...s)=>e.handleComposition&&e.handleComposition(...s)),onCompositionend:t[5]||(t[5]=(...s)=>e.handleComposition&&e.handleComposition(...s))}),null,16,Dt)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(y(),w("div",{key:1,class:L(`${e.prefixCls}-word-limit`)},X(e.valueLength)+"/"+X(e.computedMaxLength),3)):q("v-if",!0),e.showClearBtn?(y(),w("div",{key:2,class:L(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...s)=>e.handleClear&&e.handleClear(...s))},[i(d,null,{default:x(()=>[i(u)]),_:1})],2)):q("v-if",!0)],16)}var Be=ze(jt,[["render",Ft]]);const Kt=Object.assign(Be,{install:(e,t)=>{lt(e,t);const o=st(t);e.component(o+Be.name,Be)}}),qt=re({name:"TypographyEditContent",components:{Input:rt},props:{text:{type:String,required:!0}},emits:["change","end","update:text"],setup(e,{emit:t}){const r=[`${ge("typography")}-edit-content`],p=b();function f(u){t("update:text",u),t("change",u)}function l(){t("end")}return be(()=>{if(!p.value||!p.value.$el)return;const u=p.value.$el.querySelector("input");if(!u)return;u.focus&&u.focus();const{length:d}=u.value;u.setSelectionRange(d,d)}),{classNames:r,inputRef:p,onBlur:l,onChange:f,onEnd:l}}});function Wt(e,t,o,r,p,f){const l=N("Input");return y(),w("div",{class:L(e.classNames)},[i(l,{ref:"inputRef","auto-size":"","model-value":e.text,onBlur:e.onBlur,onInput:e.onChange,onKeydown:We(e.onEnd,["enter"])},null,8,["model-value","onBlur","onInput","onKeydown"])],2)}var Ut=ze(qt,[["render",Wt]]);const Gt=re({name:"TypographyOperations",components:{Tooltip:Oe,IconCheckCircleFill:it,IconCopy:ut,IconEdit:ct},props:{editable:Boolean,copyable:Boolean,expandable:Boolean,isCopied:Boolean,isEllipsis:Boolean,expanded:Boolean,forceRenderExpand:Boolean,editTooltipProps:Object,copyTooltipProps:Object},emits:{edit:()=>!0,copy:()=>!0,expand:()=>!0},setup(e,{emit:t}){const o=ge("typography"),r=B(()=>e.forceRenderExpand||e.expandable&&e.isEllipsis),{t:p}=dt();return{prefixCls:o,showExpand:r,t:p,onEditClick(){t("edit")},onCopyClick(){t("copy")},onExpandClick(){t("expand")}}}});function Jt(e,t,o,r,p,f){const l=N("IconEdit"),u=N("Tooltip"),d=N("IconCheckCircleFill"),s=N("IconCopy");return y(),w(Te,null,[e.editable?(y(),ne(u,ae({key:0,content:e.t("typography.edit")},e.editTooltipProps),{default:x(()=>[K("span",{class:L(`${e.prefixCls}-operation-edit`),onClick:t[0]||(t[0]=ke((...m)=>e.onEditClick&&e.onEditClick(...m),["stop"]))},[i(l)],2)]),_:1},16,["content"])):q("v-if",!0),e.copyable?(y(),ne(u,pt(ae({key:1},e.copyTooltipProps)),{content:x(()=>[we(e.$slots,"copy-tooltip",{copied:e.isCopied},()=>[Ee(X(e.isCopied?e.t("typography.copied"):e.t("typography.copy")),1)])]),default:x(()=>[K("span",{class:L({[`${e.prefixCls}-operation-copied`]:e.isCopied,[`${e.prefixCls}-operation-copy`]:!e.isCopied}),onClick:t[1]||(t[1]=ke((...m)=>e.onCopyClick&&e.onCopyClick(...m),["stop"]))},[we(e.$slots,"copy-icon",{copied:e.isCopied},()=>[e.isCopied?(y(),ne(d,{key:0})):(y(),ne(s,{key:1}))])],2)]),_:3},16)):q("v-if",!0),e.showExpand?(y(),w("a",{key:2,class:L(`${e.prefixCls}-operation-expand`),onClick:t[2]||(t[2]=ke((...m)=>e.onExpandClick&&e.onExpandClick(...m),["stop"]))},[we(e.$slots,"expand-node",{expanded:e.expanded},()=>[Ee(X(e.expanded?e.t("typography.collapse"):e.t("typography.expand")),1)])],2)):q("v-if",!0)],64)}var je=ze(Gt,[["render",Jt]]);let S;function Qt(e){return Array.prototype.slice.apply(e).map(o=>`${o}: ${e.getPropertyValue(o)};`).join("")}function Re(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var Xt=(e,t,o,r)=>{S||(S=document.createElement("div"),document.body.appendChild(S));const{rows:p,suffix:f,ellipsisStr:l}=t,u=window.getComputedStyle(e),d=Qt(u),s=Re(u.lineHeight),m=Math.round(s*p+Re(u.paddingTop)+Re(u.paddingBottom));S.setAttribute("style",d),S.setAttribute("aria-hidden","true"),S.style.height="auto",S.style.minHeight="auto",S.style.maxHeight="auto",S.style.position="fixed",S.style.left="0",S.style.top="-99999999px",S.style.zIndex="-200",S.style.whiteSpace="normal";const M=Ue({render(){return i("span",null,[o])}});M.mount(S);const W=Array.prototype.slice.apply(S.childNodes[0].cloneNode(!0).childNodes);M.unmount(),S.innerHTML="";const j=document.createTextNode(`${l}${f}`);S.appendChild(j),W.forEach(E=>{S.appendChild(E)});const V=document.createTextNode(r);S.insertBefore(V,j);function a(){return S.offsetHeight<=m}if(a())return{ellipsis:!1,text:r};function h(E,k=0,_=r.length,D=0){const F=Math.floor((k+_)/2),Y=r.slice(0,F);if(E.textContent=Y,k>=_-1)for(let I=_;I>=k;I-=1){const z=r.slice(0,I);if(E.textContent=z,a()||!z)return}a()?h(E,F,_,F):h(E,k,F,D)}return h(V),{text:V.textContent,ellipsis:!0}};const Yt=async e=>{var t;if((t=navigator.clipboard)!=null&&t.writeText)try{await navigator.clipboard.writeText(e);return}catch(f){console.error(f!=null?f:new DOMException("The request is not allowed","NotAllowedError"))}const o=document.createElement("span");o.textContent=e,o.style.whiteSpace="pre",document.body.appendChild(o);const r=window.getSelection(),p=window.document.createRange();r==null||r.removeAllRanges(),p.selectNode(o),r==null||r.addRange(p);try{window.document.execCommand("copy")}catch(f){console.error(`execCommand Error: ${f}`)}r==null||r.removeAllRanges(),window.document.body.removeChild(o)};let pe;function Zt(e){if(!e)return"";pe||(pe=document.createElement("div"),pe.setAttribute("aria-hidden","true"),document.body.appendChild(pe));const t=Ue({render(){return i("div",null,[e])}});t.mount(pe);const o=pe.innerText;return t.unmount(),o}var eo=Object.defineProperty,to=Object.defineProperties,oo=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,no=Object.prototype.hasOwnProperty,ao=Object.prototype.propertyIsEnumerable,Fe=(e,t,o)=>t in e?eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,lo=(e,t)=>{for(var o in t||(t={}))no.call(t,o)&&Fe(e,o,t[o]);if(De)for(var o of De(t))ao.call(t,o)&&Fe(e,o,t[o]);return e},so=(e,t)=>to(e,oo(t));function Ge(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!yt(e)}function ro(e){const{bold:t,mark:o,underline:r,delete:p,code:f}=e,l=[];return t&&l.push("b"),r&&l.push("u"),p&&l.push("del"),f&&l.push("code"),o&&l.push("mark"),l}function Ke(e,t){const{mark:o}=e,r=ro(e),p=oe(o)&&o.color?{backgroundColor:o.color}:{};return r.reduce((f,l)=>i(l,l==="mark"?{style:p}:{},Ge(f)?f:{default:()=>[f]}),t)}function io(e){const t=!!e.showTooltip,o=oe(e.showTooltip)&&e.showTooltip.type==="popover"?mt:Oe,r=oe(e.showTooltip)&&e.showTooltip.props||{};return so(lo({rows:1,suffix:"",ellipsisStr:"...",expandable:!1,css:!1},qe(e,["showTooltip"])),{showTooltip:t,TooltipComponent:o,tooltipProps:r})}var uo=re({name:"TypographyBase",inheritAttrs:!1,props:{component:{type:String,required:!0},type:{type:String},bold:{type:Boolean},mark:{type:[Boolean,Object],default:!1},underline:{type:Boolean},delete:{type:Boolean},code:{type:Boolean},disabled:{type:Boolean},editable:{type:Boolean},editing:{type:Boolean,default:void 0},defaultEditing:{type:Boolean},editText:{type:String},copyable:{type:Boolean},copyText:{type:String},copyDelay:{type:Number,default:3e3},ellipsis:{type:[Boolean,Object],default:!1},editTooltipProps:{type:Object},copyTooltipProps:{type:Object}},emits:{editStart:()=>!0,change:e=>!0,"update:editText":e=>!0,editEnd:()=>!0,"update:editing":e=>!0,copy:e=>!0,ellipsis:e=>!0,expand:e=>!0},setup(e,{slots:t,emit:o,attrs:r}){const{editing:p,defaultEditing:f,ellipsis:l,copyable:u,editable:d,copyText:s,editText:m,copyDelay:M,component:W}=Pe(e),j=ge("typography"),V=B(()=>[j,{[`${j}-${e.type}`]:e.type,[`${j}-disabled`]:e.disabled}]),a=b(),h=b(""),[E,k]=ft(f.value,vt({value:p})),_=B(()=>d.value&&E.value);function D(){o("update:editing",!0),o("editStart"),k(!0)}function F(c){o("update:editText",c),o("change",c)}function Y(){E.value&&(o("update:editing",!1),o("editEnd"),k(!1))}const I=b(!1);let z=null;function ie(){var c;const H=(c=s.value)!=null?c:h.value;Yt(H||""),I.value=!0,o("copy",H),z=setTimeout(()=>{I.value=!1},M.value)}Ve(()=>{z&&clearTimeout(z),z=null});const A=b(!1),O=b(!1),J=b(""),R=B(()=>io(oe(l.value)&&l.value||{}));let Q=null;function le(){const c=!O.value;O.value=c,o("expand",c)}function ue(c=!1){return R.value.css?i(je,{editable:d.value,copyable:u.value,expandable:R.value.expandable,isCopied:I.value,isEllipsis:$.value,expanded:O.value,forceRenderExpand:c||O.value,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:D,onCopy:ie,onExpand:le},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]}):i(je,{editable:d.value,copyable:u.value,expandable:R.value.expandable,isCopied:I.value,isEllipsis:A.value,expanded:O.value,forceRenderExpand:c,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:D,onCopy:ie,onExpand:le},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]})}function ve(){if(!a.value)return;const{ellipsis:c,text:H}=Xt(a.value,R.value,ue(!!R.value.expandable),h.value);A.value!==c&&(A.value=c,R.value.css||o("ellipsis",c)),J.value!==H&&(J.value=H||"")}function Z(){l.value&&!O.value&&(Ae(Q),Q=ht(()=>{ve()}))}Ve(()=>{Ae(Q)}),he(()=>R.value.rows,()=>{Z()}),he(l,c=>{c?Z():A.value=!1});let ee=[];const ce=()=>{if(l.value||u.value||d.value){const c=Zt(ee);c!==h.value&&(h.value=c,Z())}};be(ce),Ne(ce);const se=b(),$=b(!1),U=()=>{if(a.value&&se.value){const c=se.value.offsetHeight>a.value.offsetHeight;c!==$.value&&($.value=c,o("ellipsis",c))}},T=B(()=>O.value?{}:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":R.value.rows,"-webkit-box-orient":"vertical"});return()=>{var c,H;if(ee=((c=t.default)==null?void 0:c.call(t))||[],_.value){const g=(H=m.value)!=null?H:h.value;return i(Ut,{text:g,onChange:G=>{G!==g&&F(G)},onEnd:Y},null)}const{suffix:ye,ellipsisStr:me,showTooltip:de,tooltipProps:Ce,TooltipComponent:_e}=R.value,te=A.value&&!O.value,n=te&&!de?{title:h.value}:{},v=W.value;if(R.value.css){const g=Ke(e,ee),G=i(v,ae({class:V.value,ref:a,style:T.value},n,r),{default:()=>[i("span",{ref:se},[g])]});return $.value?i(_e,ae(Ce,{onResize:()=>U()}),{default:()=>[G],content:()=>h.value}):i(Ie,{onResize:()=>{U()}},Ge(G)?G:{default:()=>[G]})}const C=Ke(e,te?J.value:ee);return i(Ie,{onResize:()=>Z()},{default:()=>[i(v,ae({class:V.value,ref:a},n,r),{default:()=>[te&&de?i(_e,Ce,{default:()=>[i("span",null,[C])],content:()=>h.value}):C,te?me:null,ye,ue()]})]})}}}),co=re({name:"TypographyParagraph",inheritAttrs:!1,props:{blockquote:{type:Boolean},spacing:{type:String,default:"default"}},setup(e){const{blockquote:t,spacing:o}=Pe(e),r=ge("typography"),p=B(()=>t!=null&&t.value?"blockquote":"div"),f=B(()=>[{[`${r}-spacing-close`]:(o==null?void 0:o.value)==="close"}]);return{component:p,classNames:f}},render(){const{component:e,classNames:t}=this;return i(uo,ae({class:t},this.$attrs,{component:e}),this.$slots)}});const po={key:0,class:"dark:text-white w-[4px] h-[20px] block animate-blink"},fo={key:0},vo=["innerHTML"],yo=["textContent"],mo=["textContent"],ho=re({__name:"MessageContent",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean},asRawText:{type:Boolean}},setup(e){const t=e,o=b(),r=new Ot({linkify:!0,highlight(d,s){if(!!(s&&xe.getLanguage(s))){const M=s!=null?s:"";return u(xe.highlight(d,{language:M}).value,M)}return u(xe.highlightAuto(d).value,"")}});r.use(Nt,{attrs:{target:"_blank",rel:"noopener"}}),r.use(Mt,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const p=B(()=>["message-content","min-w-[20px]","rounded-md",t.inversion?"text-[#f1f1f1]":"bg-[#e5e6eb]",t.inversion?"text-[]":"dark:bg-[#1e1e20]",t.inversion?"message-request":"message-reply",{"text-red-500":t.error}]),f=d=>d.replace(/\n+$/g,""),l=B(()=>{var s;const d=f((s=t.text)!=null?s:"");return!t.asRawText&&!t.inversion?r.render(d):d});function u(d,s){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${s}</span><span class="code-block-header__copy">复制代码</span></div><code class="hljs code-block-body ${s}">${d}</code></pre>`}return Ne(()=>{Se(()=>{o.value&&xe.highlightBlock(o.value)})}),(d,s)=>(y(),w("div",{class:L(P(p))},[e.loading?(y(),w("span",po)):(y(),w("div",{key:1,ref_key:"textRef",ref:o,class:"leading-relaxed break-words"},[e.inversion?(y(),w("div",{key:1,class:"whitespace-pre-wrap",textContent:X(P(l))},null,8,mo)):(y(),w("div",fo,[e.asRawText?(y(),w("div",{key:1,class:"whitespace-pre-wrap",textContent:X(P(l))},null,8,yo)):(y(),w("div",{key:0,class:"markdown-body",innerHTML:P(l)},null,8,vo))]))],512))],2))}});const go=gt(ho,[["__scopeId","data-v-cf02b953"]]);const bo="/assets/openai-white-1b79b841.svg";function Je(e){const t={origin:!0,...e};let o;t.origin?o=document.createElement("textarea"):o=document.createElement("input"),o.setAttribute("readonly","readonly"),o.value=t.text,document.body.appendChild(o),o.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(o)}function Co(){function e(){document.querySelectorAll(".code-block-wrapper").forEach(o=>{const r=o.querySelector(".code-block-header__copy"),p=o.querySelector(".code-block-body");r&&p&&r.addEventListener("click",()=>{var f,l,u;(f=navigator.clipboard)!=null&&f.writeText?(navigator.clipboard.writeText((l=p.textContent)!=null?l:""),fe.clear(),fe.success("复制成功")):(Je({text:(u=p.textContent)!=null?u:"",origin:!0}),fe.clear(),fe.success("复制成功"))})})}be(()=>e()),Ne(()=>e())}const _o=e=>/^[\s\n\r]*$/.test(e),xo={key:0,class:"flex-1"},wo={class:"chat-wrapper"},ko={class:"flex items-center gap-x-2 w-full"},To=["src"],So={key:0,class:"text-info"},Eo={key:0,class:"message-item__actions"},$o={class:"chat-footer"},Bo={class:"flex items-center gap-x-2 w-32"},Ro={class:"flex-1"},Oo=re({__name:"ChatView",setup(e){Co();const t=bt(),o=Ct(),r=B(()=>t.session),{isMobileScreen:p}=_t(),f={user:Pt,assistant:bo},l=b(),u=b("新的聊天");xt(()=>{var a;u.value=((a=t.session)==null?void 0:a.topic)||"新的聊天"});const d=b(""),s=b(),m=()=>{if(_o(d.value)){fe.clear(),fe.error("请输入消息内容");return}t.sendMessageAction(d.value,()=>{var a,h,E,k;(k=l.value)==null||k.scrollTop(((E=(h=(a=l.value)==null?void 0:a.containerRef)==null?void 0:h.scrollHeight)!=null?E:0)-200)},a=>{s.value=a}),d.value=""};be(()=>{Se(()=>{var a,h,E,k;(k=l.value)==null||k.scrollTop(((E=(h=(a=l.value)==null?void 0:a.containerRef)==null?void 0:h.scrollHeight)!=null?E:0)-200)})});const M=a=>{o.changeSubmitKeyAction(a)},W=()=>{t.handleChangeSessionTopicAction(u.value)},j=a=>{o.submitKey===$e.Enter&&(a.shiftKey&&a.code==="Enter"?(a.preventDefault(),d.value+=`
`):!a.shiftKey&&a.code==="Enter"&&(a.preventDefault(),m())),o.submitKey===$e.ShiftEnter&&(!a.shiftKey&&a.code==="Enter"?(a.preventDefault(),d.value+=`
`):a.shiftKey&&a.code==="Enter"&&(a.preventDefault(),m()))},V=a=>{Je({text:a})};return(a,h)=>{const E=co,k=wt,_=kt,D=Tt,F=St,Y=Et,I=zt,z=$t,ie=N("icon-copy"),A=Bt,O=Oe,J=go,R=Rt,Q=N("icon-record-stop"),le=Kt,ue=N("icon-send"),ve=N("icon-down"),Z=N("icon-check"),ee=At,ce=Vt,se=It;return y(),w(Te,null,[i(F,{class:"h-14 px-4 flex items-center bg-white dark:bg-dark"},{default:x(()=>[K("div",{class:L(["flex flex-col editable-title__wrapper",{"is-mobile":P(p)}])},[i(E,{class:"m-0",editable:"",editText:P(u),"onUpdate:editText":h[0]||(h[0]=$=>He(u)?u.value=$:null),onEditEnd:W},{default:x(()=>[Ee(X(P(u)),1)]),_:1},8,["editText"])],2),P(p)?q("",!0):(y(),w("i",xo)),P(p)?q("",!0):(y(),ne(D,{key:1},{default:x(()=>[i(k,{class:"w-44"}),i(_,{class:"w-60"})]),_:1}))]),_:1}),i(Y,{class:"m-0"}),i(se,{class:"flex flex-col flex-1 overflow-hidden"},{default:x(()=>[K("main",wo,[i(R,{ref_key:"scrollbarRef",ref:l,"outer-style":"flex: 1; overflow: hidden;",class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2"},{default:x(()=>{var $,U;return[(y(!0),w(Te,null,Le((U=($=P(r))==null?void 0:$.messages)!=null?U:[],T=>(y(),w("section",{key:T.id,class:L(["message-item",[T.role==="assistant"?"is-reply":"is-request"]])},[K("div",ko,[i(z,{loading:T.streaming&&T.role==="assistant"},{default:x(()=>[i(I,{size:32,class:L(T.role==="assistant"?"bg-primary p-2":"bg-success")},{default:x(()=>{var c;return[K("img",{src:(c=f[T.role])!=null?c:""},null,8,To)]}),_:2},1032,["class"])]),_:2},1032,["loading"])]),T.streaming&&T.role==="assistant"?(y(),w("small",So," 正在输入... ")):q("",!0),K("section",{class:L(["message-item__content",{"justify-end bg-primary text-white":T.role==="user"},{"bg-white dark:bg-dark":T.role==="assistant"}])},[T.role==="assistant"?(y(),w("div",Eo,[i(O,{"content-class":"text-xs",content:"复制",position:"top"},{default:x(()=>[i(A,{onClick:c=>V(T.content),size:"mini",shape:"circle",type:"text"},{default:x(()=>[i(ie,{class:"text-base"})]),_:2},1032,["onClick"])]),_:2},1024)])):q("",!0),(y(),ne(J,{key:T.content,text:T.content,inversion:T.role!=="assistant"},null,8,["text","inversion"]))],2)],2))),128))]}),_:1},512),i(Y,{class:"m-0"}),K("footer",$o,[i(z,{loading:P(t).fetching,class:"footer-spin"},{icon:x(()=>[i(O,{"content-class":"text-xs",content:"停止",position:"top"},{default:x(()=>[i(A,{onClick:h[1]||(h[1]=$=>{var U;return(U=P(s))==null?void 0:U.abort()}),shape:"circle",status:"danger"},{default:x(()=>[i(Q,{class:"text-lg"})]),_:1})]),_:1})]),default:x(()=>[i(le,{modelValue:P(d),"onUpdate:modelValue":h[2]||(h[2]=$=>He(d)?d.value=$:null),onKeydown:We(ke(j,["prevent"]),["enter"]),class:"bg-white dark:bg-dark-900 border-none","auto-size":{minRows:3,maxRows:5},placeholder:"请输入您的消息..."},null,8,["modelValue","onKeydown"]),i(ce,{onClick:m,onSelect:M,type:"primary"},{icon:x(()=>[i(ve)]),content:x(()=>[(y(!0),w(Te,null,Le(Object.values(P($e)),$=>(y(),ne(ee,{key:$,value:$},{default:x(()=>[K("div",Bo,[K("span",Ro,X($),1),$===P(o).submitKey?(y(),ne(Z,{key:0,class:"text-primary"})):q("",!0)])]),_:2},1032,["value"]))),128))]),default:x(()=>[i(ue,{class:"mr-2"}),Ee(" 发送 ")]),_:1})]),_:1},8,["loading"])])])]),_:1})],64)}}});export{Oo as default};
