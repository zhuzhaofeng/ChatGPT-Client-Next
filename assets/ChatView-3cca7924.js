import{g as ie,R as Re,I as Ge,h as Je,t as ze,i as ge,u as Ye,r as g,j as S,k as Qe,l as me,m as Xe,n as Ze,q as oe,s as Ce,v as Ne,x as et,y as De,z as Le,A as tt,C as ke,D as U,o as h,E,F as q,G as ot,H as ae,J as K,b as u,w as I,a as te,K as le,L as we,M as nt,N as at,O as lt,P as st,T as Oe,Q as rt,U as it,V as ut,W as ct,c as re,X as Se,d as Te,Y as dt,Z as Ie,$ as We,a0 as pt,a1 as ft,a2 as Pe,a3 as Me,a4 as He,a5 as vt,a6 as yt,a7 as ht,a8 as H,_ as mt,a9 as ne,aa as gt,ab as Ct,ac as bt,ad as xt,ae as Ve,af as _t,ag as wt,ah as kt,ai as Tt,aj as St,ak as Et,B as $t,S as Bt,al as Rt,am as It,an as Ee,ao as Pt,ap as zt}from"./index-d9d1dd09.js";import{M as Nt,H as _e,m as Ot,a as Ht}from"./index-b7903ef7.js";const Lt=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Mt=e=>{const t={};return Lt.forEach(o=>{t[o]=e.getPropertyValue(o)}),t},Vt=ie({name:"Textarea",components:{ResizeObserver:Re,IconHover:Ge,IconClose:Je},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:o}){const{disabled:i,error:d,modelValue:c}=ze(e),r=ge("textarea"),{mergedDisabled:s,mergedError:f,eventHandlers:l}=Ye({disabled:i,error:d}),m=g(),z=g(),D=g(),A=g(),j=g(e.defaultValue),C=S(()=>{var a;return(a=c.value)!=null?a:j.value}),[P,L]=Qe(m);me(c,a=>{(Xe(a)||Ze(a))&&(j.value="")});const N=S(()=>oe(e.maxLength)&&!!e.maxLength.errorOnly),n=S(()=>oe(e.maxLength)?e.maxLength.length:e.maxLength),v=a=>{var y;return et(e.wordLength)?e.wordLength(a):(y=a.length)!=null?y:0},_=S(()=>v(C.value)),$=S(()=>f.value||!!(n.value&&N.value&&_.value>n.value)),w=g(!1),M=g(!1),ue=S(()=>e.allowClear&&!s.value&&C.value),F=g(!1),V=g(""),Y=()=>{P(),ke(()=>{m.value&&C.value!==m.value.value&&(m.value.value=C.value,L())})},B=(a,y=!0)=>{var x,b;n.value&&!N.value&&v(a)>n.value&&(a=(b=(x=e.wordSlice)==null?void 0:x.call(e,a,n.value))!=null?b:a.slice(0,n.value)),j.value=a,y&&t("update:modelValue",a),Y()};let W=C.value;const Q=(a,y)=>{var x,b;a!==W&&(W=a,t("change",a,y),(b=(x=l.value)==null?void 0:x.onChange)==null||b.call(x,y))},ce=a=>{var y,x;M.value=!0,W=C.value,t("focus",a),(x=(y=l.value)==null?void 0:y.onFocus)==null||x.call(y,a)},ve=a=>{var y,x;M.value=!1,t("blur",a),(x=(y=l.value)==null?void 0:y.onBlur)==null||x.call(y,a),Q(C.value,a)},X=a=>{var y,x;const{value:b}=a.target;if(a.type==="compositionend"){if(F.value=!1,V.value="",n.value&&!N.value&&C.value.length>=n.value&&v(b)>n.value){Y();return}t("input",b,a),B(b),(x=(y=l.value)==null?void 0:y.onInput)==null||x.call(y,a)}else F.value=!0},Z=a=>{var y,x;const{value:b}=a.target;if(F.value)V.value=b;else{if(n.value&&!N.value&&C.value.length>=n.value&&v(b)>n.value&&a.inputType==="insertText"){Y();return}t("input",b,a),B(b),(x=(y=l.value)==null?void 0:y.onInput)==null||x.call(y,a)}},de=a=>{B(""),Q("",a),t("clear",a)};me(c,a=>{a!==C.value&&B(a!=null?a:"",!1)});const se=a=>De(o,Le),O=a=>tt(o,Le),G=S(()=>[`${r}-wrapper`,{[`${r}-focus`]:M.value,[`${r}-disabled`]:s.value,[`${r}-error`]:$.value,[`${r}-scroll`]:w.value}]);let k;const p=g(0),R=g(0),ye=S(()=>!oe(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*p.value+R.value),he=S(()=>!oe(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*p.value+R.value),pe=()=>{const a=Mt(k);p.value=Number.parseInt(a["line-height"]||0,10),R.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),A.value=a,ke(()=>{var y;const x=(y=D.value)==null?void 0:y.offsetHeight;let b=x!=null?x:0,J="hidden";ye.value&&b<ye.value&&(b=ye.value),he.value&&b>he.value&&(b=he.value,J="auto"),z.value={height:`${b}px`,resize:"none",overflow:J}})};Ce(()=>{m.value&&(k=window.getComputedStyle(m.value),e.autoSize&&pe()),ee()});const be=()=>{e.autoSize&&D.value&&pe(),ee()},xe=a=>{m.value&&a.target!==m.value&&(a.preventDefault(),m.value.focus())},ee=()=>{m.value&&(m.value.scrollHeight>m.value.offsetHeight?w.value||(w.value=!0):w.value&&(w.value=!1))};return me(C,()=>{e.autoSize&&D.value&&pe(),ee()}),{prefixCls:r,wrapperCls:G,textareaRef:m,textareaStyle:z,mirrorRef:D,mirrorStyle:A,computedValue:C,showClearBtn:ue,valueLength:_,computedMaxLength:n,mergedDisabled:s,getWrapperAttrs:se,getTextareaAttrs:O,handleInput:Z,handleFocus:ce,handleBlur:ve,handleComposition:X,handleClear:de,handleResize:be,handleMousedown:xe}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),At=["disabled","value","placeholder"];function jt(e,t,o,i,d,c){const r=U("resize-observer"),s=U("icon-close"),f=U("icon-hover");return h(),E("div",le(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...l)=>e.handleMousedown&&e.handleMousedown(...l))}),[e.autoSize?(h(),E("div",{key:0,ref:"mirrorRef",class:q(`${e.prefixCls}-mirror`),style:ot(e.mirrorStyle)},ae(`${e.computedValue}
`),7)):K("v-if",!0),u(r,{onResize:e.handleResize},{default:I(()=>[te("textarea",le({ref:"textareaRef"},e.getTextareaAttrs(e.$attrs),{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...l)=>e.handleInput&&e.handleInput(...l)),onFocus:t[1]||(t[1]=(...l)=>e.handleFocus&&e.handleFocus(...l)),onBlur:t[2]||(t[2]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onCompositionstart:t[3]||(t[3]=(...l)=>e.handleComposition&&e.handleComposition(...l)),onCompositionupdate:t[4]||(t[4]=(...l)=>e.handleComposition&&e.handleComposition(...l)),onCompositionend:t[5]||(t[5]=(...l)=>e.handleComposition&&e.handleComposition(...l))}),null,16,At)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(h(),E("div",{key:1,class:q(`${e.prefixCls}-word-limit`)},ae(e.valueLength)+"/"+ae(e.computedMaxLength),3)):K("v-if",!0),e.showClearBtn?(h(),E("div",{key:2,class:q(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...l)=>e.handleClear&&e.handleClear(...l))},[u(f,null,{default:I(()=>[u(s)]),_:1})],2)):K("v-if",!0)],16)}var $e=Ne(Vt,[["render",jt]]);const Ft=Object.assign($e,{install:(e,t)=>{nt(e,t);const o=at(t);e.component(o+$e.name,$e)}}),qt=ie({name:"TypographyEditContent",components:{Input:lt},props:{text:{type:String,required:!0}},emits:["change","end","update:text"],setup(e,{emit:t}){const i=[`${ge("typography")}-edit-content`],d=g();function c(s){t("update:text",s),t("change",s)}function r(){t("end")}return Ce(()=>{if(!d.value||!d.value.$el)return;const s=d.value.$el.querySelector("input");if(!s)return;s.focus&&s.focus();const{length:f}=s.value;s.setSelectionRange(f,f)}),{classNames:i,inputRef:d,onBlur:r,onChange:c,onEnd:r}}});function Dt(e,t,o,i,d,c){const r=U("Input");return h(),E("div",{class:q(e.classNames)},[u(r,{ref:"inputRef","auto-size":"","model-value":e.text,onBlur:e.onBlur,onInput:e.onChange,onKeydown:st(e.onEnd,["enter"])},null,8,["model-value","onBlur","onInput","onKeydown"])],2)}var Wt=Ne(qt,[["render",Dt]]);const Kt=ie({name:"TypographyOperations",components:{Tooltip:Oe,IconCheckCircleFill:rt,IconCopy:it,IconEdit:ut},props:{editable:Boolean,copyable:Boolean,expandable:Boolean,isCopied:Boolean,isEllipsis:Boolean,expanded:Boolean,forceRenderExpand:Boolean,editTooltipProps:Object,copyTooltipProps:Object},emits:{edit:()=>!0,copy:()=>!0,expand:()=>!0},setup(e,{emit:t}){const o=ge("typography"),i=S(()=>e.forceRenderExpand||e.expandable&&e.isEllipsis),{t:d}=ct();return{prefixCls:o,showExpand:i,t:d,onEditClick(){t("edit")},onCopyClick(){t("copy")},onExpandClick(){t("expand")}}}});function Ut(e,t,o,i,d,c){const r=U("IconEdit"),s=U("Tooltip"),f=U("IconCheckCircleFill"),l=U("IconCopy");return h(),E(Ie,null,[e.editable?(h(),re(s,le({key:0,content:e.t("typography.edit")},e.editTooltipProps),{default:I(()=>[te("span",{class:q(`${e.prefixCls}-operation-edit`),onClick:t[0]||(t[0]=Se((...m)=>e.onEditClick&&e.onEditClick(...m),["stop"]))},[u(r)],2)]),_:1},16,["content"])):K("v-if",!0),e.copyable?(h(),re(s,dt(le({key:1},e.copyTooltipProps)),{content:I(()=>[we(e.$slots,"copy-tooltip",{copied:e.isCopied},()=>[Te(ae(e.isCopied?e.t("typography.copied"):e.t("typography.copy")),1)])]),default:I(()=>[te("span",{class:q({[`${e.prefixCls}-operation-copied`]:e.isCopied,[`${e.prefixCls}-operation-copy`]:!e.isCopied}),onClick:t[1]||(t[1]=Se((...m)=>e.onCopyClick&&e.onCopyClick(...m),["stop"]))},[we(e.$slots,"copy-icon",{copied:e.isCopied},()=>[e.isCopied?(h(),re(f,{key:0})):(h(),re(l,{key:1}))])],2)]),_:3},16)):K("v-if",!0),e.showExpand?(h(),E("a",{key:2,class:q(`${e.prefixCls}-operation-expand`),onClick:t[2]||(t[2]=Se((...m)=>e.onExpandClick&&e.onExpandClick(...m),["stop"]))},[we(e.$slots,"expand-node",{expanded:e.expanded},()=>[Te(ae(e.expanded?e.t("typography.collapse"):e.t("typography.expand")),1)])],2)):K("v-if",!0)],64)}var Ae=Ne(Kt,[["render",Ut]]);let T;function Gt(e){return Array.prototype.slice.apply(e).map(o=>`${o}: ${e.getPropertyValue(o)};`).join("")}function Be(e){if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var Jt=(e,t,o,i)=>{T||(T=document.createElement("div"),document.body.appendChild(T));const{rows:d,suffix:c,ellipsisStr:r}=t,s=window.getComputedStyle(e),f=Gt(s),l=Be(s.lineHeight),m=Math.round(l*d+Be(s.paddingTop)+Be(s.paddingBottom));T.setAttribute("style",f),T.setAttribute("aria-hidden","true"),T.style.height="auto",T.style.minHeight="auto",T.style.maxHeight="auto",T.style.position="fixed",T.style.left="0",T.style.top="-99999999px",T.style.zIndex="-200",T.style.whiteSpace="normal";const z=We({render(){return u("span",null,[o])}});z.mount(T);const D=Array.prototype.slice.apply(T.childNodes[0].cloneNode(!0).childNodes);z.unmount(),T.innerHTML="";const A=document.createTextNode(`${r}${c}`);T.appendChild(A),D.forEach(L=>{T.appendChild(L)});const j=document.createTextNode(i);T.insertBefore(j,A);function C(){return T.offsetHeight<=m}if(C())return{ellipsis:!1,text:i};function P(L,N=0,n=i.length,v=0){const _=Math.floor((N+n)/2),$=i.slice(0,_);if(L.textContent=$,N>=n-1)for(let w=n;w>=N;w-=1){const M=i.slice(0,w);if(L.textContent=M,C()||!M)return}C()?P(L,_,n,_):P(L,N,_,v)}return P(j),{text:j.textContent,ellipsis:!0}};const Yt=async e=>{var t;if((t=navigator.clipboard)!=null&&t.writeText)try{await navigator.clipboard.writeText(e);return}catch(c){console.error(c!=null?c:new DOMException("The request is not allowed","NotAllowedError"))}const o=document.createElement("span");o.textContent=e,o.style.whiteSpace="pre",document.body.appendChild(o);const i=window.getSelection(),d=window.document.createRange();i==null||i.removeAllRanges(),d.selectNode(o),i==null||i.addRange(d);try{window.document.execCommand("copy")}catch(c){console.error(`execCommand Error: ${c}`)}i==null||i.removeAllRanges(),window.document.body.removeChild(o)};let fe;function Qt(e){if(!e)return"";fe||(fe=document.createElement("div"),fe.setAttribute("aria-hidden","true"),document.body.appendChild(fe));const t=We({render(){return u("div",null,[e])}});t.mount(fe);const o=fe.innerText;return t.unmount(),o}var Xt=Object.defineProperty,Zt=Object.defineProperties,eo=Object.getOwnPropertyDescriptors,je=Object.getOwnPropertySymbols,to=Object.prototype.hasOwnProperty,oo=Object.prototype.propertyIsEnumerable,Fe=(e,t,o)=>t in e?Xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,no=(e,t)=>{for(var o in t||(t={}))to.call(t,o)&&Fe(e,o,t[o]);if(je)for(var o of je(t))oo.call(t,o)&&Fe(e,o,t[o]);return e},ao=(e,t)=>Zt(e,eo(t));function Ke(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vt(e)}function lo(e){const{bold:t,mark:o,underline:i,delete:d,code:c}=e,r=[];return t&&r.push("b"),i&&r.push("u"),d&&r.push("del"),c&&r.push("code"),o&&r.push("mark"),r}function qe(e,t){const{mark:o}=e,i=lo(e),d=oe(o)&&o.color?{backgroundColor:o.color}:{};return i.reduce((c,r)=>u(r,r==="mark"?{style:d}:{},Ke(c)?c:{default:()=>[c]}),t)}function so(e){const t=!!e.showTooltip,o=oe(e.showTooltip)&&e.showTooltip.type==="popover"?yt:Oe,i=oe(e.showTooltip)&&e.showTooltip.props||{};return ao(no({rows:1,suffix:"",ellipsisStr:"...",expandable:!1,css:!1},De(e,["showTooltip"])),{showTooltip:t,TooltipComponent:o,tooltipProps:i})}var ro=ie({name:"TypographyBase",inheritAttrs:!1,props:{component:{type:String,required:!0},type:{type:String},bold:{type:Boolean},mark:{type:[Boolean,Object],default:!1},underline:{type:Boolean},delete:{type:Boolean},code:{type:Boolean},disabled:{type:Boolean},editable:{type:Boolean},editing:{type:Boolean,default:void 0},defaultEditing:{type:Boolean},editText:{type:String},copyable:{type:Boolean},copyText:{type:String},copyDelay:{type:Number,default:3e3},ellipsis:{type:[Boolean,Object],default:!1},editTooltipProps:{type:Object},copyTooltipProps:{type:Object}},emits:{editStart:()=>!0,change:e=>!0,"update:editText":e=>!0,editEnd:()=>!0,"update:editing":e=>!0,copy:e=>!0,ellipsis:e=>!0,expand:e=>!0},setup(e,{slots:t,emit:o,attrs:i}){const{editing:d,defaultEditing:c,ellipsis:r,copyable:s,editable:f,copyText:l,editText:m,copyDelay:z,component:D}=ze(e),A=ge("typography"),j=S(()=>[A,{[`${A}-${e.type}`]:e.type,[`${A}-disabled`]:e.disabled}]),C=g(),P=g(""),[L,N]=pt(c.value,ft({value:d})),n=S(()=>f.value&&L.value);function v(){o("update:editing",!0),o("editStart"),N(!0)}function _(p){o("update:editText",p),o("change",p)}function $(){L.value&&(o("update:editing",!1),o("editEnd"),N(!1))}const w=g(!1);let M=null;function ue(){var p;const R=(p=l.value)!=null?p:P.value;Yt(R||""),w.value=!0,o("copy",R),M=setTimeout(()=>{w.value=!1},z.value)}Pe(()=>{M&&clearTimeout(M),M=null});const F=g(!1),V=g(!1),Y=g(""),B=S(()=>so(oe(r.value)&&r.value||{}));let W=null;function Q(){const p=!V.value;V.value=p,o("expand",p)}function ce(p=!1){return B.value.css?u(Ae,{editable:f.value,copyable:s.value,expandable:B.value.expandable,isCopied:w.value,isEllipsis:O.value,expanded:V.value,forceRenderExpand:p||V.value,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:v,onCopy:ue,onExpand:Q},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]}):u(Ae,{editable:f.value,copyable:s.value,expandable:B.value.expandable,isCopied:w.value,isEllipsis:F.value,expanded:V.value,forceRenderExpand:p,editTooltipProps:e.editTooltipProps,copyTooltipProps:e.copyTooltipProps,onEdit:v,onCopy:ue,onExpand:Q},{"copy-tooltip":t["copy-tooltip"],"copy-icon":t["copy-icon"],"expand-node":t["expand-node"]})}function ve(){if(!C.value)return;const{ellipsis:p,text:R}=Jt(C.value,B.value,ce(!!B.value.expandable),P.value);F.value!==p&&(F.value=p,B.value.css||o("ellipsis",p)),Y.value!==R&&(Y.value=R||"")}function X(){r.value&&!V.value&&(Me(W),W=ht(()=>{ve()}))}Pe(()=>{Me(W)}),me(()=>B.value.rows,()=>{X()}),me(r,p=>{p?X():F.value=!1});let Z=[];const de=()=>{if(r.value||s.value||f.value){const p=Qt(Z);p!==P.value&&(P.value=p,X())}};Ce(de),He(de);const se=g(),O=g(!1),G=()=>{if(C.value&&se.value){const p=se.value.offsetHeight>C.value.offsetHeight;p!==O.value&&(O.value=p,o("ellipsis",p))}},k=S(()=>V.value?{}:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":B.value.rows,"-webkit-box-orient":"vertical"});return()=>{var p,R;if(Z=((p=t.default)==null?void 0:p.call(t))||[],n.value){const b=(R=m.value)!=null?R:P.value;return u(Wt,{text:b,onChange:J=>{J!==b&&_(J)},onEnd:$},null)}const{suffix:ye,ellipsisStr:he,showTooltip:pe,tooltipProps:be,TooltipComponent:xe}=B.value,ee=F.value&&!V.value,a=ee&&!pe?{title:P.value}:{},y=D.value;if(B.value.css){const b=qe(e,Z),J=u(y,le({class:j.value,ref:C,style:k.value},a,i),{default:()=>[u("span",{ref:se},[b])]});return O.value?u(xe,le(be,{onResize:()=>G()}),{default:()=>[J],content:()=>P.value}):u(Re,{onResize:()=>{G()}},Ke(J)?J:{default:()=>[J]})}const x=qe(e,ee?Y.value:Z);return u(Re,{onResize:()=>X()},{default:()=>[u(y,le({class:j.value,ref:C},a,i),{default:()=>[ee&&pe?u(xe,be,{default:()=>[u("span",null,[x])],content:()=>P.value}):x,ee?he:null,ye,ce()]})]})}}}),io=ie({name:"TypographyParagraph",inheritAttrs:!1,props:{blockquote:{type:Boolean},spacing:{type:String,default:"default"}},setup(e){const{blockquote:t,spacing:o}=ze(e),i=ge("typography"),d=S(()=>t!=null&&t.value?"blockquote":"div"),c=S(()=>[{[`${i}-spacing-close`]:(o==null?void 0:o.value)==="close"}]);return{component:d,classNames:c}},render(){const{component:e,classNames:t}=this;return u(ro,le({class:t},this.$attrs,{component:e}),this.$slots)}});const uo={key:0,class:"dark:text-white w-[4px] h-[20px] block animate-blink"},co={key:0},po=["innerHTML"],fo=["textContent"],vo=["textContent"],yo=ie({__name:"MessageContent",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean},asRawText:{type:Boolean}},setup(e){const t=e,o=g(),i=new Nt({linkify:!0,highlight(f,l){if(!!(l&&_e.getLanguage(l))){const z=l!=null?l:"";return s(_e.highlight(f,{language:z}).value,z)}return s(_e.highlightAuto(f).value,"")}});i.use(Ot,{attrs:{target:"_blank",rel:"noopener"}}),i.use(Ht,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const d=S(()=>["message-content","min-w-[20px]","rounded-md",t.inversion?"text-[#f1f1f1]":"bg-[#e5e6eb]",t.inversion?"text-[]":"dark:bg-[#1e1e20]",t.inversion?"message-request":"message-reply",{"text-red-500":t.error}]),c=f=>f.replace(/\n+$/g,""),r=S(()=>{var l;const f=c((l=t.text)!=null?l:"");return!t.asRawText&&!t.inversion?i.render(f):f});function s(f,l){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${l}</span><span class="code-block-header__copy">复制代码</span></div><code class="hljs code-block-body ${l}">${f}</code></pre>`}return He(()=>{ke(()=>{o.value&&_e.highlightBlock(o.value)})}),(f,l)=>(h(),E("div",{class:q(H(d))},[e.loading?(h(),E("span",uo)):(h(),E("div",{key:1,ref_key:"textRef",ref:o,class:"leading-relaxed break-words"},[e.inversion?(h(),E("div",{key:1,class:"whitespace-pre-wrap",textContent:ae(H(r))},null,8,vo)):(h(),E("div",co,[e.asRawText?(h(),E("div",{key:1,class:"whitespace-pre-wrap",textContent:ae(H(r))},null,8,fo)):(h(),E("div",{key:0,class:"markdown-body",innerHTML:H(r)},null,8,po))]))],512))],2))}});const ho=mt(yo,[["__scopeId","data-v-cf02b953"]]);const mo="/assets/openai-white-1b79b841.svg";function Ue(e){const t={origin:!0,...e};let o;t.origin?o=document.createElement("textarea"):o=document.createElement("input"),o.setAttribute("readonly","readonly"),o.value=t.text,document.body.appendChild(o),o.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(o)}function go(){function e(){document.querySelectorAll(".code-block-wrapper").forEach(o=>{const i=o.querySelector(".code-block-header__copy"),d=o.querySelector(".code-block-body");i&&d&&i.addEventListener("click",()=>{var c,r,s;(c=navigator.clipboard)!=null&&c.writeText?(navigator.clipboard.writeText((r=d.textContent)!=null?r:""),ne.clear(),ne.success("复制成功")):(Ue({text:(s=d.textContent)!=null?s:"",origin:!0}),ne.clear(),ne.success("复制成功"))})})}Ce(()=>e()),He(()=>e())}const Co=e=>/^[\s\n\r]*$/.test(e),bo={key:0,class:"flex-1"},xo={class:"chat-wrapper"},_o=["src"],wo={key:0,class:"text-info"},ko={key:0,class:"message-item__actions"},To={class:"chat-footer"},$o=ie({__name:"ChatView",setup(e){go();const t=gt(),o=Ct(),i=S(()=>t.session),{isMobileScreen:d}=bt(),c=g(!1),r={user:It,assistant:mo},s=g(),f=g("新的聊天");xt(()=>{var n;f.value=((n=t.session)==null?void 0:n.topic)||"新的聊天"});const l=g(""),m=n=>{c.value=!1,t.messageRetryAction(n,()=>{var v,_,$,w;c.value||(w=s.value)==null||w.scrollTop((($=(_=(v=s.value)==null?void 0:v.containerRef)==null?void 0:_.scrollHeight)!=null?$:0)-200)},v=>{z.value=v})},z=g(),D=()=>{if(Co(l.value)){ne.clear(),ne.error("请输入消息内容");return}c.value=!1,t.sendMessageAction(l.value,()=>{var n,v,_,$;c.value||($=s.value)==null||$.scrollTop(((_=(v=(n=s.value)==null?void 0:n.containerRef)==null?void 0:v.scrollHeight)!=null?_:0)-200)},n=>{z.value=n}),l.value=""},A=n=>{n.deltaY<10&&(c.value=!0)};Ce(()=>{ke(()=>{var n,v,_,$,w;($=s.value)==null||$.scrollTop(((_=(v=(n=s.value)==null?void 0:n.containerRef)==null?void 0:v.scrollHeight)!=null?_:0)-200),(w=s.value)==null||w.$el.querySelector(".arco-scrollbar-container").addEventListener("wheel",A)})});const j=n=>{var v,_,$;(((v=n==null?void 0:n.target)==null?void 0:v.scrollTop)||0)+(((_=n==null?void 0:n.target)==null?void 0:_.offsetHeight)||0)>=((($=n==null?void 0:n.target)==null?void 0:$.scrollHeight)||0)-70&&(c.value=!1)};Pe(()=>{var n;(n=s.value)==null||n.$el.querySelector(".arco-scrollbar-container").removeEventListener("wheel",A)});const C=()=>{t.handleChangeSessionTopicAction(f.value)},P=n=>{d.value?n.key==="Enter"&&(n.preventDefault(),D()):n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),D())},L=n=>{Ue({text:n}),ne.clear(),ne.success("复制成功")},N=S(()=>`请输入您的消息，${o.submitKey} 发送，${o.submitKey===Ee.Enter?Ee.ShiftEnter:Ee.Enter} 换行`);return(n,v)=>{const _=io,$=wt,w=kt,M=Tt,ue=St,F=Et,V=Pt,Y=zt,B=U("icon-copy"),W=$t,Q=Oe,ce=U("icon-sync"),ve=ho,X=Bt,Z=U("icon-record-stop"),de=Ft,se=Rt;return h(),E(Ie,null,[u(ue,{class:"h-14 px-4 flex items-center bg-white dark:bg-dark"},{default:I(()=>[te("div",{class:q(["flex flex-col editable-title__wrapper",{"is-mobile":H(d)}])},[u(_,{class:"m-0",editable:"",editText:H(f),"onUpdate:editText":v[0]||(v[0]=O=>Ve(f)?f.value=O:null),onEditEnd:C},{default:I(()=>[Te(ae(H(f)),1)]),_:1},8,["editText"])],2),H(d)?K("",!0):(h(),E("i",bo)),H(d)?K("",!0):(h(),re(M,{key:1},{default:I(()=>[u($,{class:"w-44"}),u(w,{class:"w-60"})]),_:1}))]),_:1}),u(F,{class:"m-0"}),u(se,{class:"flex flex-col flex-1 overflow-hidden"},{default:I(()=>[te("main",xo,[u(X,{ref_key:"scrollbarRef",ref:s,onScroll:j,"outer-style":"flex: 1; overflow: hidden; ",class:"overflow-y-auto h-full p-4 flex flex-col gap-y-2 pb-20"},{default:I(()=>{var O,G;return[(h(!0),E(Ie,null,_t((G=(O=H(i))==null?void 0:O.messages)!=null?G:[],(k,p)=>(h(),E("section",{key:k.id,class:q(["message-item",[k.role==="assistant"?"is-reply":"is-request"]])},[u(Y,{loading:k.streaming&&k.role==="assistant"},{default:I(()=>[u(V,{size:32,class:q(k.role==="assistant"?"bg-primary p-2":"bg-success")},{default:I(()=>{var R;return[te("img",{src:(R=r[k.role])!=null?R:""},null,8,_o)]}),_:2},1032,["class"])]),_:2},1032,["loading"]),k.streaming&&k.role==="assistant"?(h(),E("small",wo," 正在输入... ")):K("",!0),te("section",{class:q(["message-item__content",{"is-user":k.role==="user"},{"is-assistant":k.role==="assistant"}])},[k.role==="assistant"?(h(),E("div",ko,[u(Q,{"content-class":"text-xs",content:"复制",position:"top"},{default:I(()=>[u(W,{onClick:R=>L(k.content),size:"mini",shape:"circle",type:"text"},{default:I(()=>[u(B,{class:"text-base"})]),_:2},1032,["onClick"])]),_:2},1024),u(Q,{"content-class":"text-xs",content:"重试",position:"top"},{default:I(()=>[u(W,{onClick:R=>m(p),size:"mini",shape:"circle",type:"text"},{default:I(()=>[u(ce,{class:"text-base"})]),_:2},1032,["onClick"])]),_:2},1024)])):K("",!0),(h(),re(ve,{key:k.content,text:k.content,inversion:k.role!=="assistant"},null,8,["text","inversion"]))],2)],2))),128))]}),_:1},512),u(F,{class:"m-0"}),te("footer",To,[H(t).fetching?(h(),re(W,{key:0,onClick:v[1]||(v[1]=O=>{var G;return(G=H(z))==null?void 0:G.abort()}),shape:"round",status:"danger",class:"stop-receiving"},{default:I(()=>[u(Z,{class:"text-lg mr-2"}),Te(" 停止 ")]),_:1})):K("",!0),u(de,{modelValue:H(l),"onUpdate:modelValue":v[2]||(v[2]=O=>Ve(l)?l.value=O:null),onKeypress:P,class:"bg-white dark:bg-dark-900 border-none","auto-size":{minRows:4,maxRows:6},placeholder:H(N)},null,8,["modelValue","placeholder"])])])]),_:1})],64)}}});export{$o as default};
